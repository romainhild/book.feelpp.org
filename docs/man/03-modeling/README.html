<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>Modeling with Feel++</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments, .listingblock .pygments code { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Modeling with Feel++</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_advection_models">Advection Models</a>
<ul class="sectlevel1">
<li><a href="#_json_file">JSON file</a>
<ul class="sectlevel2">
<li><a href="#_properties">Properties</a></li>
<li><a href="#_boundary_conditions">Boundary Conditions</a></li>
</ul>
</li>
<li><a href="#_action">Action</a>
<ul class="sectlevel2">
<li><a href="#_feel_code">Feel++ code</a></li>
<li><a href="#_configuration_file">Configuration file</a></li>
<li><a href="#_json_file_2">Json file</a></li>
<li><a href="#_compilation_execution">Compilation/Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_computational_fluid_mechanics_toolbox">Computational Fluid Mechanics Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_notations_and_units">Notations and units</a></li>
<li><a href="#_Équations">Équations</a></li>
<li><a href="#_materials">Materials</a>
<ul class="sectlevel2">
<li><a href="#_generalised_newtonian_fluid">Generalised Newtonian fluid</a></li>
<li><a href="#_boundary_conditions_2">Boundary Conditions</a></li>
<li><a href="#_neumann">Neumann</a></li>
<li><a href="#_slip">Slip</a></li>
<li><a href="#_inlet">Inlet</a></li>
<li><a href="#_outlet_flow">Outlet flow</a></li>
<li><a href="#_implementation_of_boundary_conditions_in_json">Implementation of boundary conditions in json</a></li>
<li><a href="#_options_summary">Options summary</a></li>
</ul>
</li>
<li><a href="#_volumic_forces">Volumic forces</a>
<ul class="sectlevel2">
<li><a href="#_post_processing">Post Processing</a></li>
<li><a href="#_action_2">Action</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_computational_solid_mechanics_toolbox">Computational Solid Mechanics Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_notations">Notations</a></li>
<li><a href="#_models">Models</a>
<ul class="sectlevel2">
<li><a href="#_linear_elasticity">Linear elasticity</a></li>
<li><a href="#_hyper_elasticity">Hyper-elasticity</a></li>
</ul>
</li>
<li><a href="#_materials_2">Materials</a></li>
<li><a href="#_boundary_conditions_3">Boundary Conditions</a></li>
<li><a href="#_volumic_forces_2">Volumic forces</a></li>
<li><a href="#_post_process">Post Process</a>
<ul class="sectlevel2">
<li><a href="#_exports_for_visualisation">Exports for visualisation</a></li>
<li><a href="#_measures_2">Measures</a></li>
</ul>
</li>
<li><a href="#_action_3">Action</a>
<ul class="sectlevel2">
<li><a href="#_feel_code_3">Feel++ code</a></li>
<li><a href="#_configuration_file_3">Configuration file</a></li>
<li><a href="#_json_file_4">Json file</a></li>
<li><a href="#_compilation_execution_3">Compilation/Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_fluid_structure_interaction_models">Fluid Structure Interaction Models</a>
<ul class="sectlevel1">
<li><a href="#_models_2">Models</a></li>
<li><a href="#_fluid_structure_coupling_conditions">Fluid structure coupling conditions</a>
<ul class="sectlevel2">
<li><a href="#_fluid_structure_coupling_conditions_with_1d_reduced_model">Fluid structure coupling conditions with 1D reduced model</a></li>
<li><a href="#_variables_symbols_and_units">Variables, symbols and units</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_thermo_electric_toolbox">Thermo-Electric Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_electrostatic_problem">Electrostatic problem</a></li>
<li><a href="#_heat_transfer_problem">Heat transfer problem</a></li>
<li><a href="#_thermo_electric_problem">Thermo-Electric problem</a></li>
<li><a href="#_running_the_thermo_electric_application">Running the Thermo-electric application</a></li>
</ul>
</li>
<li><a href="#_maxwell_equations">Maxwell Equations</a></li>
<li><a href="#_maxwell_s_equations">Maxwell&#8217;s equations</a>
<ul class="sectlevel1">
<li><a href="#_differential_form_of_maxwell_equations">Differential form of Maxwell equations</a>
<ul class="sectlevel2">
<li><a href="#_variables_symbols_and_units_2">Variables, symbols and units</a></li>
<li><a href="#_constitutive_relations">Constitutive relations</a></li>
<li><a href="#_classification_of_maxwell_s_equations">Classification of Maxwell&#8217;s Equations</a></li>
</ul>
</li>
<li><a href="#_magnetostatic_problem_formulation">Magnetostatic problem formulation</a></li>
<li><a href="#_vector_potential_formulation_for_magnetostatic">Vector Potential formulation for magnetostatic</a>
<ul class="sectlevel2">
<li><a href="#_benchmark">Benchmark</a></li>
<li><a href="#_regularized_point_system">Regularized point system</a></li>
<li><a href="#_saddle_point_system">Saddle point system</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_resolution_strategy">Resolution strategy</a>
<ul class="sectlevel1">
<li><a href="#_polarisation_method">Polarisation method</a>
<ul class="sectlevel2">
<li><a href="#_abstract_fixed_point_iteration">Abstract fixed point iteration</a></li>
<li><a href="#_fixed_point_iteration_for_the_a_formulation">Fixed point iteration for the A formulation</a></li>
</ul>
</li>
<li><a href="#_picard_method">Picard method</a></li>
<li><a href="#_linking_picard_to_the_polarization">Linking Picard to the Polarization</a></li>
<li><a href="#_formulations">Formulations</a>
<ul class="sectlevel2">
<li><a href="#_saddle_point_formulation">Saddle-point formulation</a></li>
<li><a href="#_regularized_formulation">Regularized formulation</a></li>
</ul>
</li>
<li><a href="#_solver_and_preconditionner">Solver and Preconditionner</a>
<ul class="sectlevel2">
<li><a href="#_outer_solver">Outer solver</a></li>
<li><a href="#_inner_solver">Inner solver</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_torus_benchmark">Torus Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description">Description</a>
<ul class="sectlevel2">
<li><a href="#_boundary_conditions_4">Boundary conditions</a></li>
</ul>
</li>
<li><a href="#_inputs">Inputs</a></li>
<li><a href="#_outputs">Outputs</a></li>
<li><a href="#_discretization_3">Discretization</a></li>
<li><a href="#_implementation">Implementation</a></li>
<li><a href="#_results">Results</a>
<ul class="sectlevel2">
<li><a href="#_potential_vector">Potential vector</a></li>
<li><a href="#_magnetic_flux">Magnetic flux</a></li>
</ul>
</li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</li>
<li><a href="#_inductor_benchmark">Inductor Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description_2">Description</a>
<ul class="sectlevel2">
<li><a href="#_geometry">Geometry</a></li>
<li><a href="#_magnetic_permeability">Magnetic permeability</a></li>
<li><a href="#_boundary_conditions_5">Boundary conditions</a></li>
</ul>
</li>
<li><a href="#_inputs_2">Inputs</a></li>
<li><a href="#_outputs_2">Outputs</a></li>
<li><a href="#_discretization_4">Discretization</a></li>
<li><a href="#_results_2">Results</a>
<ul class="sectlevel2">
<li><a href="#_linear_simulations">Linear simulations</a></li>
<li><a href="#_non_linear_simulations">Non linear simulations</a></li>
</ul>
</li>
<li><a href="#_conclusion_2">Conclusion</a></li>
</ul>
</li>
<li><a href="#_team_workshop_13_benchmark">Team Workshop 13 Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description_3">Description</a>
<ul class="sectlevel2">
<li><a href="#_geometry_2">Geometry</a></li>
<li><a href="#_magnetic_permeability_2">Magnetic permeability</a></li>
</ul>
</li>
<li><a href="#_inputs_3">Inputs</a></li>
<li><a href="#_outputs_3">Outputs</a></li>
<li><a href="#_behavior">Behavior</a>
<ul class="sectlevel2">
<li><a href="#_getdp_non_linear_curve">GetDP non linear curve</a></li>
<li><a href="#_intermediate_non_linear_curve">Intermediate non linear curve</a></li>
<li><a href="#_team_workshop_13_non_linear_curve">TEAM Workshop 13 non linear curve</a></li>
</ul>
</li>
<li><a href="#_comparision_with_team_workshop_13">Comparision with Team Workshop 13</a></li>
<li><a href="#_remarks">Remarks</a></li>
<li><a href="#_propositions">Propositions</a>
<ul class="sectlevel2">
<li><a href="#_polarization">Polarization</a></li>
<li><a href="#_continuity">Continuity</a></li>
<li><a href="#_mixing_polarization_and_picard">Mixing Polarization and Picard.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="_advection_models" class="sect0">Advection Models</h1>
<div id="toc" class="toc2">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_advection_models">Advection Models</a>
<ul class="sectlevel1">
<li><a href="#_json_file">JSON file</a>
<ul class="sectlevel2">
<li><a href="#_properties">Properties</a></li>
<li><a href="#_boundary_conditions">Boundary Conditions</a></li>
</ul>
</li>
<li><a href="#_action">Action</a>
<ul class="sectlevel2">
<li><a href="#_feel_code">Feel++ code</a></li>
<li><a href="#_configuration_file">Configuration file</a></li>
<li><a href="#_json_file_2">Json file</a></li>
<li><a href="#_compilation_execution">Compilation/Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_computational_fluid_mechanics_toolbox">Computational Fluid Mechanics Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_notations_and_units">Notations and units</a></li>
<li><a href="#_Équations">Équations</a></li>
<li><a href="#_materials">Materials</a>
<ul class="sectlevel2">
<li><a href="#_generalised_newtonian_fluid">Generalised Newtonian fluid</a></li>
<li><a href="#_boundary_conditions_2">Boundary Conditions</a></li>
<li><a href="#_neumann">Neumann</a></li>
<li><a href="#_slip">Slip</a></li>
<li><a href="#_inlet">Inlet</a></li>
<li><a href="#_outlet_flow">Outlet flow</a></li>
<li><a href="#_implementation_of_boundary_conditions_in_json">Implementation of boundary conditions in json</a></li>
<li><a href="#_options_summary">Options summary</a></li>
</ul>
</li>
<li><a href="#_volumic_forces">Volumic forces</a>
<ul class="sectlevel2">
<li><a href="#_post_processing">Post Processing</a></li>
<li><a href="#_action_2">Action</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_computational_solid_mechanics_toolbox">Computational Solid Mechanics Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_notations">Notations</a></li>
<li><a href="#_models">Models</a>
<ul class="sectlevel2">
<li><a href="#_linear_elasticity">Linear elasticity</a></li>
<li><a href="#_hyper_elasticity">Hyper-elasticity</a></li>
</ul>
</li>
<li><a href="#_materials_2">Materials</a></li>
<li><a href="#_boundary_conditions_3">Boundary Conditions</a></li>
<li><a href="#_volumic_forces_2">Volumic forces</a></li>
<li><a href="#_post_process">Post Process</a>
<ul class="sectlevel2">
<li><a href="#_exports_for_visualisation">Exports for visualisation</a></li>
<li><a href="#_measures_2">Measures</a></li>
</ul>
</li>
<li><a href="#_action_3">Action</a>
<ul class="sectlevel2">
<li><a href="#_feel_code_3">Feel++ code</a></li>
<li><a href="#_configuration_file_3">Configuration file</a></li>
<li><a href="#_json_file_4">Json file</a></li>
<li><a href="#_compilation_execution_3">Compilation/Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_fluid_structure_interaction_models">Fluid Structure Interaction Models</a>
<ul class="sectlevel1">
<li><a href="#_models_2">Models</a></li>
<li><a href="#_fluid_structure_coupling_conditions">Fluid structure coupling conditions</a>
<ul class="sectlevel2">
<li><a href="#_fluid_structure_coupling_conditions_with_1d_reduced_model">Fluid structure coupling conditions with 1D reduced model</a></li>
<li><a href="#_variables_symbols_and_units">Variables, symbols and units</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_thermo_electric_toolbox">Thermo-Electric Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_electrostatic_problem">Electrostatic problem</a></li>
<li><a href="#_heat_transfer_problem">Heat transfer problem</a></li>
<li><a href="#_thermo_electric_problem">Thermo-Electric problem</a></li>
<li><a href="#_running_the_thermo_electric_application">Running the Thermo-electric application</a></li>
</ul>
</li>
<li><a href="#_maxwell_equations">Maxwell Equations</a></li>
<li><a href="#_maxwell_s_equations">Maxwell&#8217;s equations</a>
<ul class="sectlevel1">
<li><a href="#_differential_form_of_maxwell_equations">Differential form of Maxwell equations</a>
<ul class="sectlevel2">
<li><a href="#_variables_symbols_and_units_2">Variables, symbols and units</a></li>
<li><a href="#_constitutive_relations">Constitutive relations</a></li>
<li><a href="#_classification_of_maxwell_s_equations">Classification of Maxwell&#8217;s Equations</a></li>
</ul>
</li>
<li><a href="#_magnetostatic_problem_formulation">Magnetostatic problem formulation</a></li>
<li><a href="#_vector_potential_formulation_for_magnetostatic">Vector Potential formulation for magnetostatic</a>
<ul class="sectlevel2">
<li><a href="#_benchmark">Benchmark</a></li>
<li><a href="#_regularized_point_system">Regularized point system</a></li>
<li><a href="#_saddle_point_system">Saddle point system</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_resolution_strategy">Resolution strategy</a>
<ul class="sectlevel1">
<li><a href="#_polarisation_method">Polarisation method</a>
<ul class="sectlevel2">
<li><a href="#_abstract_fixed_point_iteration">Abstract fixed point iteration</a></li>
<li><a href="#_fixed_point_iteration_for_the_a_formulation">Fixed point iteration for the A formulation</a></li>
</ul>
</li>
<li><a href="#_picard_method">Picard method</a></li>
<li><a href="#_linking_picard_to_the_polarization">Linking Picard to the Polarization</a></li>
<li><a href="#_formulations">Formulations</a>
<ul class="sectlevel2">
<li><a href="#_saddle_point_formulation">Saddle-point formulation</a></li>
<li><a href="#_regularized_formulation">Regularized formulation</a></li>
</ul>
</li>
<li><a href="#_solver_and_preconditionner">Solver and Preconditionner</a>
<ul class="sectlevel2">
<li><a href="#_outer_solver">Outer solver</a></li>
<li><a href="#_inner_solver">Inner solver</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_torus_benchmark">Torus Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description">Description</a>
<ul class="sectlevel2">
<li><a href="#_boundary_conditions_4">Boundary conditions</a></li>
</ul>
</li>
<li><a href="#_inputs">Inputs</a></li>
<li><a href="#_outputs">Outputs</a></li>
<li><a href="#_discretization_3">Discretization</a></li>
<li><a href="#_implementation">Implementation</a></li>
<li><a href="#_results">Results</a>
<ul class="sectlevel2">
<li><a href="#_potential_vector">Potential vector</a></li>
<li><a href="#_magnetic_flux">Magnetic flux</a></li>
</ul>
</li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</li>
<li><a href="#_inductor_benchmark">Inductor Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description_2">Description</a>
<ul class="sectlevel2">
<li><a href="#_geometry">Geometry</a></li>
<li><a href="#_magnetic_permeability">Magnetic permeability</a></li>
<li><a href="#_boundary_conditions_5">Boundary conditions</a></li>
</ul>
</li>
<li><a href="#_inputs_2">Inputs</a></li>
<li><a href="#_outputs_2">Outputs</a></li>
<li><a href="#_discretization_4">Discretization</a></li>
<li><a href="#_results_2">Results</a>
<ul class="sectlevel2">
<li><a href="#_linear_simulations">Linear simulations</a></li>
<li><a href="#_non_linear_simulations">Non linear simulations</a></li>
</ul>
</li>
<li><a href="#_conclusion_2">Conclusion</a></li>
</ul>
</li>
<li><a href="#_team_workshop_13_benchmark">Team Workshop 13 Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description_3">Description</a>
<ul class="sectlevel2">
<li><a href="#_geometry_2">Geometry</a></li>
<li><a href="#_magnetic_permeability_2">Magnetic permeability</a></li>
</ul>
</li>
<li><a href="#_inputs_3">Inputs</a></li>
<li><a href="#_outputs_3">Outputs</a></li>
<li><a href="#_behavior">Behavior</a>
<ul class="sectlevel2">
<li><a href="#_getdp_non_linear_curve">GetDP non linear curve</a></li>
<li><a href="#_intermediate_non_linear_curve">Intermediate non linear curve</a></li>
<li><a href="#_team_workshop_13_non_linear_curve">TEAM Workshop 13 non linear curve</a></li>
</ul>
</li>
<li><a href="#_comparision_with_team_workshop_13">Comparision with Team Workshop 13</a></li>
<li><a href="#_remarks">Remarks</a></li>
<li><a href="#_propositions">Propositions</a>
<ul class="sectlevel2">
<li><a href="#_polarization">Polarization</a></li>
<li><a href="#_continuity">Continuity</a></li>
<li><a href="#_mixing_polarization_and_picard">Mixing Polarization and Picard.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_json_file">JSON file</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s describe how the json file is build.</p>
</div>
<div class="sect2">
<h3 id="_properties">Properties</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Table of Models for <code>model</code> option</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Model</th>
<th class="tableblock halign-left valign-top">Name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Advection</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stokes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Stokes</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_boundary_conditions">Boundary Conditions</h3>
<div class="paragraph">
<p>Boundary conditions are set in the json files</p>
</div>
<div class="listingblock">
<div class="title">Example for boundary conditions</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;BoundaryConditions&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;field&quot;</span><span class="tok-p">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;&lt;condition type&gt;&quot;</span><span class="tok-p">:</span>
        <span class="tok-p">{</span>
            <span class="tok-nt">&quot;marker&quot;</span><span class="tok-p">:</span>
            <span class="tok-p">{</span>
                <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;value&quot;</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>where all component of vectorial field can be access with <code>&lt;field&gt;_x</code> for the x component where <code>&lt;field&gt;</code> is the name of the vectorial field.<br>
The condition types are explain in the two following tables.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Boundary conditions</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dirichlet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces, edges and component-wise</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Dirichlet"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neumann</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scalar, vectorial</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Neumann_scalar" or "Neumann_vectorial"</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_action">Action</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here is a example code, that use this model on a ring domain.</p>
</div>
<div class="sect2">
<h3 id="_feel_code">Feel++ code</h3>
<div class="paragraph">
<p>Here is the code</p>
</div>
<div class="paragraph">
<p>First at all, we define our model type with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>typedef FeelModels::Advection&lt;
        Simplex&lt;FEELPP_DIM,1&gt;,
        Lagrange&lt;OrderAdvection, Scalar,Continuous,PointSetFekete&gt; &gt; model_type;</pre>
</div>
</div>
<div class="paragraph">
<p>This definition allows us to create our advection model object FM like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre>auto Adv = model_type::New("advection");</pre>
</div>
</div>
<div class="paragraph">
<p>The method <code>New</code> retrieve all data from the configuration and json files, as well build a mesh if need.</p>
</div>
<div class="paragraph">
<p>With this object, we can initialize our model parameters, such as boundaries conditions. Data on our model and on the numeric solver are then save and print on the terminal. This is made by</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adv-&gt;init();
Adv-&gt;printAndSaveInfo();</pre>
</div>
</div>
<div class="paragraph">
<p>Now that our model is completed, we can solve the associated problem. To begin the resolution</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adv-&gt;isStationary()</pre>
</div>
</div>
<div class="paragraph">
<p>determine if our model is stationary or not.</p>
</div>
<div class="paragraph">
<p>If it is, then we need to solve our system only one time and export the obtained results.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Adv-&gt;solve();
Adv-&gt;exportResults();</pre>
</div>
</div>
<div class="paragraph">
<p>If it&#8217;s not, our model is time reliant, and a loop on time is necessary. Our model is then solved and the results are export at each time step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> for ( ; !Adv-&gt;timeStepBase()-&gt;isFinished(); Adv-&gt;updateTimeStep() )
 {
   Adv-&gt;solve();
   Adv-&gt;exportResults();
 }</pre>
</div>
</div>
<div class="sect3">
<h4 id="_code">Code</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cpp"><span class="tok-p">{</span><span class="tok-o">%</span> <span class="tok-n">include</span> <span class="tok-s">&quot;../Examples/advection_model.cpp&quot;</span> <span class="tok-o">%</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_file">Configuration file</h3>
<div class="paragraph">
<p>The config file is used to define options, linked to our case, we would have the possibility to change at will. It can be, for example, files paths as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#      advection
[advection]
geofile=$cfgdir/ring2d.geo
filename=$cfgdir/ring2d.json

[exporter]
directory=simul/advect2d/ring/data
format=ensightgold</pre>
</div>
</div>
<div class="paragraph">
<p>It can also be resolution dependent parameters such as mesh elements size, methods used  to define our problem and solvers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>#       time
[advection.bdf]
order=2
[ts]
time-initial=0.0
time-step=1
time-final=1
steady=true

[advection.gmsh]
hsize=0.03

# backend advection and projection
pc-factor-mat-solver-package-type=mumps
pc-type=lu

#ksp-monitor=1
ksp-converged-reason=true
ksp-maxit=1000
#snes-monitor=1
snes-converged-reason=true
snes-maxit-reuse=3
snes-ksp-maxit-reuse=20</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, we choose LU as the preconditioner method, with a mesh size equal to 0.03. As for time discretization, we use a BDF at order 2.</p>
</div>
<div class="sect3">
<h4 id="_code_2">Code</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span class="tok-na">{% include &quot;../Examples/ring2d.cfg&quot; %}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_json_file_2">Json file</h3>
<div class="paragraph">
<p>First at all, we define some general information like the name ( and short name ) and the model we would like to use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Name&quot;</span><span class="tok-err">:</span> <span class="tok-s2">&quot;Ring2d&quot;</span><span class="tok-err">,</span>
<span class="tok-s2">&quot;ShortName&quot;</span><span class="tok-err">:</span> <span class="tok-s2">&quot;Ring2d&quot;</span><span class="tok-err">,</span>
<span class="tok-s2">&quot;Model&quot;</span><span class="tok-err">:</span> <span class="tok-s2">&quot;Advection&quot;</span><span class="tok-err">,</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, we have only <a href="#Boundary_Conditions">boundary conditions</a>  to define. Here, we impose homogeneous Dirichlet conditions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;BoundaryConditions&quot;</span><span class="tok-err">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;advection&quot;</span><span class="tok-p">:</span>
        <span class="tok-p">{</span>
            <span class="tok-nt">&quot;Dirichlet&quot;</span><span class="tok-p">:</span>
            <span class="tok-p">{</span>
                <span class="tok-nt">&quot;Bottom&quot;</span><span class="tok-p">:</span>
                <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;0&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-nt">&quot;Left&quot;</span><span class="tok-p">:</span>
                <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;0&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-nt">&quot;InnerCircle&quot;</span><span class="tok-p">:</span>
                <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;0&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-nt">&quot;OuterCircle&quot;</span><span class="tok-p">:</span>
                <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;0&quot;</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_code_3">Code</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-p">{</span><span class="tok-err">%</span> <span class="tok-err">include</span> <span class="tok-nt">&quot;../Examples/ring2d.json&quot;</span> <span class="tok-err">%</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compilation_execution">Compilation/Execution</h3>
<div class="paragraph">
<p>Once you&#8217;ve a build dir, you just have to realise the command <code>make</code> at</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{buildir}/applications/models/advection</pre>
</div>
</div>
<div class="paragraph">
<p>This will generate an executable named <code>feelpp_application_advection_2d</code>. To execute it, you need to give the path of the cfg file associated to your case, with <code>--config-file</code>.</p>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./feelpp_application_advection_2d --config-file={sourcedir}/applications/models/advection/ring/ring2d.cfg</pre>
</div>
</div>
<div class="paragraph">
<p>is how to execute the case ahead.</p>
</div>
<div class="paragraph">
<p>The result files are then stored by default in</p>
</div>
<div class="listingblock">
<div class="content">
<pre>feel/simul/advect2d/{domain_shape}/data/{processor_used}</pre>
</div>
</div>
<div class="paragraph">
<p>If we return once again at our example, the result files are in</p>
</div>
<div class="listingblock">
<div class="content">
<pre> feel/simul/advect2d/ring/data/np_1</pre>
</div>
</div>
</div>
</div>
</div>
<h1 id="_computational_fluid_mechanics_toolbox" class="sect0">Computational Fluid Mechanics Toolbox</h1>
<div class="sect1">
<h2 id="_notations_and_units">Notations and units</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Notation</th>
<th class="tableblock halign-left valign-top">Quantity</th>
<th class="tableblock halign-left valign-top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\rho_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fluid density</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg.m^{-3}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{u}_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fluid velocity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m.s^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{\sigma}_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fluid stress tensor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N.m^{-2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{f}^t_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">source term</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg.m^{-3}.s^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(p_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pressure fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg.m^{-1}.s^{-2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mu_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dynamic viscosity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg.m^{-1}.s^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\bar{U}\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">characteristic inflow velocity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m.s^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\nu\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kinematic viscosity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m^2.s^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(L\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">characteristic length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(m\)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_Équations">Équations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Navier-Stokes model is used to model incompressible Newtonian fluid.
It can be described by these conservative laws :</p>
</div>
<div class="stemblock">
<div class="title">Momentum conservation equation</div>
<div class="content">
\[\rho_{f} \left. \frac{\partial\mathbf{u}_f}{\partial t} \right|_\mathrm{x}
+ \rho_{f} \left( \boldsymbol{u}_{f} \cdot \nabla_{\mathrm{x}} \right) \boldsymbol{u}_{f}
- \nabla_{\mathrm{x}} \cdot \boldsymbol{\sigma}_{f} = \boldsymbol{f}^t_f , \quad \text{ in } \Omega^t_f \times \left[t_i,t_f \right]\]
</div>
</div>
<div class="openblock env equation">
<div class="title">Mass conservation equation</div>
<div class="content">
<div class="paragraph">
<p>\nabla_{\mathrm{x}} \cdot \boldsymbol{u}_{f} = 0, \quad \text{ in } \Omega^t_f \times \left[t_i,t_f \right]</p>
</div>
</div>
</div>
<div class="paragraph">
<p>we complete this set of equations with the fluid constitutive law</p>
</div>
<div class="openblock env equation">
<div class="title">Material constitutive equation</div>
<div class="content">
<div class="paragraph">
<p>\boldsymbol{\sigma}_{f} = -p_f \boldsymbol{I} + 2\mu_f D(\boldsymbol{u}_{f})</p>
</div>
</div>
</div>
<div class="paragraph">
<p>with strain tensor \(D(\boldsymbol{u}_{f})\) defined by :</p>
</div>
<div class="openblock env equation">
<div class="title">Strain tensor</div>
<div class="content">
<div class="paragraph">
<p>D(\boldsymbol{u}_{f}) = \frac{1}{2} (\nabla_\mathrm{x} \boldsymbol{u}_f + (\nabla_\mathrm{x} \boldsymbol{u}_f)^T)</p>
</div>
</div>
</div>
<div class="paragraph">
<p>An alternative model is the Stokes model. It is valid in the case of small Reynolds number. It corresponds to the same formulation than Navier-Stokes equations but without the convective term \left( \boldsymbol{u}_{f} \cdot \nabla_{\mathrm{x}} \right) \boldsymbol{u}_{f} .</p>
</div>
<div class="paragraph">
<p>The fluid mechanics model (<code>Navier-Stokes</code> or <code>Stokes</code>) can be selected in json file:</p>
</div>
<div class="listingblock">
<div class="title">Listing : select fluid model</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Model&quot;</span><span class="tok-err">:</span> <span class="tok-s2">&quot;Navier-Stokes&quot;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_materials">Materials</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The next step is to define the fluid material by setting its properties namely the density \(\rho_f\) and viscosity \(\mu_f\).
In next table, we find the correspondance between the mathematical names and the json names.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Correspondance between fluid parameters and symbols in JSon files</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Symbol</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mu_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mu</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\rho_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rho</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A <code>Materials</code> section is introduced in json file in order to configure the fluid properties. For each mesh marker, we can define the material properties associated.</p>
</div>
<div class="listingblock">
<div class="title">Listing : Materials section</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Materials&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;&lt;marker&gt;&quot;</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;water&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;rho&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;1.0e3&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;mu&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;1.0&quot;</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_generalised_newtonian_fluid">Generalised Newtonian fluid</h3>
<div class="paragraph">
<p>A non newtonian fluid is characterized by a non constant viscosity, which is a function of strain rate \(\boldsymbol{D}\left(\boldsymbol{u}_{f}\right)\). We start by introducing a metric of the rate of deformation, denoted by \(\dot{\gamma}\):</p>
</div>
<div class="openblock env equation">
<div class="title">Rate of deformation</div>
<div class="content">
<div class="paragraph">
<p>\dot{\gamma} \equiv \sqrt{2 \ tr \left( \boldsymbol{D}\left(\boldsymbol{u}_{f}\right)^{2} \right)  }</p>
</div>
</div>
</div>
<div class="paragraph">
<p>We represent the viscosity \(\mu_f\) as a function of \(\dot{\gamma}\).  The deviatoric stress tensor \(\boldsymbol{\tau}\) is obtained thanks to generalised Newtonian model, which takes the following form:</p>
</div>
<div class="openblock env equation">
<div class="title">Deviatoric stress tensor</div>
<div class="content">
<div class="literalblock">
<div class="content">
<pre>\boldsymbol{\tau} = 2 \mu_f \left(\dot{\gamma} \right) \boldsymbol{D}\left(\boldsymbol{u}_{f}\right)</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The simplest example of a generalised Newtonian model is the power-law fluid, which has a viscosity given by:</p>
</div>
<div class="openblock env equation">
<div class="title">Power law</div>
<div class="content">
<div class="paragraph">
<p>\mu_f \left(\dot{\gamma} \right) = k \dot{\gamma}^{n-1}</p>
</div>
</div>
</div>
<div class="paragraph">
<p>where \(k\) and n &lt; 1 are two parameters related to fluid properties.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Blood flow viscosity</div>
<div class="paragraph">
<p>In the context of blood flow modeling, an extension of the power model was proposed by Walburn and Schneck.</p>
</div>
<div class="paragraph">
<p>The parameters \(k\) and \(n\) are related to the hematocrit \(Ht\) and Total Proteins Minus Albumin (TPMA) as follows</p>
</div>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>k = C_1 e^{C_2 Ht} e^{C_4 \text{TPMA} / Ht }, \quad\quad    n = 1- C_3 H t</p>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>and \(C_i, i=1,..,4\) are parameters to fit with experimental data.</p>
</div>
<div class="paragraph">
<p>Another family of generalised Newtonian model can be defined from a function \(\Phi\) express by:</p>
</div>
<div class="openblock env equation">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>\Phi\left( \dot{\gamma}, \mu_{\infty},\mu_{0} \right)
= \frac{\mu\left(\dot{\gamma}\right) - \mu_{\infty}}{\mu_{0}-\mu_{\infty}}</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>where \(\mu_0\) and \(\mu_{\infty}\) are the asymptotic viscosities at zero and infinite shear rate.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Viscosity law</th>
<th class="tableblock halign-left valign-top">\(\Phi\left( \dot{\gamma}, \mu_{\infty},\mu_{0} \right) \)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Carreau</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\left(1+\left(\lambda\dot{\gamma}\right)^{2}\right)^{(n-1)/2}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Carreau-Yasuda</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\left(1+\left(\lambda\dot{\gamma}\right)^{a}\right)^{(n-1)/a}\)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The non Newtonian properties are defined in cfg file in fluid section.</p>
</div>
<div class="paragraph">
<p>The viscosity law is activated by:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Viscosity law</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">option</th>
<th class="tableblock halign-left valign-top">values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">viscosity.law</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">newtonian, power_law, walburn-schneck_law, carreau_law, carreau-yasuda_law</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Then, each model are configured with the options reported in the following table:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Viscosity law</th>
<th class="tableblock halign-left valign-top">options</th>
<th class="tableblock halign-left valign-top">unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">power_law</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">power_law.k
</p><p class="tableblock">power_law.n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dimensionless
</p><p class="tableblock">dimensionless</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">walburn-schneck_law</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hematocrit
</p><p class="tableblock">TPMA
</p><p class="tableblock">walburn-schneck_law.C1
</p><p class="tableblock">walburn-schneck_law.C2
</p><p class="tableblock">walburn-schneck_law.C3
</p><p class="tableblock">walburn-schneck_law.C4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage
</p><p class="tableblock">g/l
</p><p class="tableblock">dimensionless
</p><p class="tableblock">dimensionless
</p><p class="tableblock">dimensionless
</p><p class="tableblock">l/g</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">carreau_law</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">viscosity.zero_shear
</p><p class="tableblock">viscosity.infinite_shear
</p><p class="tableblock">carreau_law.lambda
</p><p class="tableblock">carreau_law.n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(kg.m^{-1}.s^{-1}\)
</p><p class="tableblock">dimensionless
</p><p class="tableblock">dimensionless</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">carreau-yasuda_law</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">viscosity.zero_shear
</p><p class="tableblock">viscosity.infinite_shear
</p><p class="tableblock">carreau-yasuda_law.lambda
</p><p class="tableblock">carreau-yasuda_law.n
</p><p class="tableblock">carreau-yasuda_law.a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(kg/(m \times s)\)
</p><p class="tableblock">\(kg/(m \times s)\)
</p><p class="tableblock">dimensionless
</p><p class="tableblock">dimensionless
</p><p class="tableblock">dimensionless</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_boundary_conditions_2">Boundary Conditions</h3>
<div class="paragraph">
<p>We start by a listing of boundary conditions supported in fluid mechanics model.</p>
</div>
<div class="sect3">
<h4 id="_dirichlet_on_velocity">Dirichlet on velocity</h4>
<div class="paragraph">
<p>A Dirichlet condition on velocity field reads:</p>
</div>
<div class="openblock env equation">
<div class="title">Dirichlet condition</div>
<div class="content">
<div class="paragraph">
<p>\boldsymbol{u}_f = \boldsymbol{g} \quad \text{ on } \Gamma</p>
</div>
</div>
</div>
<div class="paragraph">
<p>or only a component of vector \(\boldsymbol{u}_f =(u_f^1,u_f^2 ,u_f^3 )\)</p>
</div>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>u_f^i = g \quad \text{ on } \Gamma</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Several methods are available to enforce the boundary condition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>elimination</p>
</li>
<li>
<p>Nitsche</p>
</li>
<li>
<p>Lagrange multiplier</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_dirichlet_on_pressure">Dirichlet on pressure</h4>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>\begin{eqnarray}
p &amp;=&amp; g \\
\boldsymbol{u}_f \times \boldsymbol{n} &amp;=&amp; \boldsymbol{0}
\end{eqnarray}</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_neumann">Neumann</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. Neumann options</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neumann_scalar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{\sigma}_{f} \boldsymbol{n}  = g \ \boldsymbol{n} \)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neumann_vectorial</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{\sigma}_{f} \boldsymbol{n}  =   \boldsymbol{g} \)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neumann_tensor2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{\sigma}_{f} \boldsymbol{n}  = g \ \boldsymbol{n}\)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_slip">Slip</h3>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>\boldsymbol{u}_f \cdot \boldsymbol{n} = 0</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inlet">Inlet</h3>
<div class="paragraph">
<p>The boundary condition at inlets allow to define a velocity profile on a set of marked faces \(\Gamma_{\mathrm{inlet}}\) in fluid mesh:</p>
</div>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>\boldsymbol{u}_f = - g \ \boldsymbol{n} \quad \text{ on } \Gamma_{\mathrm{inlet}}</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The function \(g\) is computed from flow velocity profiles:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Constant profile</dt>
</dl>
</div>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>\text{Find } g \in C^0(\Gamma) \text{ such that } \\
\begin{eqnarray}
g &amp;=&amp; \beta \quad &amp;\text{ in } \Gamma \setminus \partial\Gamma
\\
g&amp;=&amp;0 \quad &amp;\text{ on } \partial\Gamma
\end{eqnarray}</p>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Parabolic profile</dt>
</dl>
</div>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>\text{Find } g \in H^2(\Gamma) \text{ such that : } \\
\begin{eqnarray}
\Delta g &amp;=&amp; \beta \quad &amp;\text{ in } \Gamma \\
g&amp;=&amp;0 \quad &amp;\text{ on } \partial\Gamma
\end{eqnarray}</p>
</div>
</div>
</div>
<div class="paragraph">
<p>where \(\beta\) is a constant determined by adding a constraint to the inflow:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">velocity_max</dt>
<dd>
<p>\(\max( g ) = \alpha \)</p>
</dd>
<dt class="hdlist1">flow_rate</dt>
<dd>
<p>\(\int_\Gamma ( g \ \boldsymbol{n} ) \cdot \boldsymbol{n} = \alpha\)</p>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Inlet flow options</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">shape</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>constant</code>,<code>parabolic</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">select a shape profile for inflow</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">constraint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>velocity_max</code>,<code>flow_rate</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">give a constraint wich controle velocity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">symbolic expression of constraint value</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_outlet_flow">Outlet flow</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. Outlet flow options</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">free,windkessel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">free</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">select an outlet modeling</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_free_outflow">Free outflow</h4>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>\boldsymbol{\sigma}_{f} \boldsymbol{n} = \boldsymbol{0}</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_windkessel_model">Windkessel model</h4>
<div class="paragraph">
<p>We use a 3-element Windkessel model for modeling an outflow boundary condition.
We define \(P_l\) a pressure and \(Q_l\) the flow rate.
The outflow model is discribed by the following system of differential equations:</p>
</div>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>\left\{
\begin{aligned}
  C_{d,l} \frac{\partial \pi_l}{\partial t} + \frac{\pi_l}{R_{d,l}} = Q_l \\
  P_l = R_{p,l} Q_l + \pi_l
\end{aligned}
\right.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Coefficients \(R_{p,l}\) and \(R_{d,l}\) represent respectively the proximal and distal resistance.
The constant \(C_{d,l}\) is the capacitance of blood vessel.
The unknowns \(P_l\) and \(\pi_l\) are called proximal pressure and distal pressure.
Then we define the coupling between this outflow model and the fluid model by these two relationships:</p>
</div>
<div class="openblock env equation">
<div class="content">
<div class="paragraph">
<p>\begin{align}
  Q_l &amp;= \int_{\Gamma_l} \boldsymbol{u}_f \cdot \boldsymbol{n}_f  \\
  \boldsymbol{\sigma}_f \boldsymbol{n}_f &amp;= -P_l \boldsymbol{n}_f
\end{align}</p>
</div>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. Windkessel options</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">windkessel_coupling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">explicit, implicit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">coupling type with the Navier-Stokes equation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">windkessel_Rd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">real</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">distal resistance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">windkessel_Rp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">real</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">proximal resistance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">windkessel_Cd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">real</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">capacitance</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_implementation_of_boundary_conditions_in_json">Implementation of boundary conditions in json</h3>
<div class="paragraph">
<p>Boundary conditions are set in the json files in the category <code>BoundaryConditions</code>.</p>
</div>
<div class="paragraph">
<p>Then <code>&lt;field&gt;</code> and <code>&lt;bc_type&gt;</code> are chosen from type of boundary condition.</p>
</div>
<div class="paragraph">
<p>The parameter <code>&lt;marker&gt;</code> corresponds to mesh marker where the boundary condition is applied.</p>
</div>
<div class="paragraph">
<p>Finally, we define some specific options inside a marker.</p>
</div>
<div class="listingblock">
<div class="title">Listing : boundary conditions in json</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;BoundaryConditions&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;&lt;field&gt;&quot;</span><span class="tok-p">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;&lt;bc_type&gt;&quot;</span><span class="tok-p">:</span>
        <span class="tok-p">{</span>
            <span class="tok-nt">&quot;&lt;marker&gt;&quot;</span><span class="tok-p">:</span>
            <span class="tok-p">{</span>
                <span class="tok-nt">&quot;&lt;option1&gt;&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;&lt;value1&gt;&quot;</span><span class="tok-p">,</span>
                <span class="tok-nt">&quot;&lt;option2&gt;&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;&lt;value2&gt;&quot;</span><span class="tok-p">,</span>
                <span class="tok-err">//</span> <span class="tok-err">...</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_options_summary">Options summary</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. Boundary conditions</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Entity</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">velocity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dirichlet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expr
</p><p class="tableblock"> type
</p><p class="tableblock"> number
</p><p class="tableblock"> alemesh_bc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces, edges, points</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">velocity_x
</p><p class="tableblock">velocity_y
</p><p class="tableblock">velocity_z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dirichlet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expr
</p><p class="tableblock"> type
</p><p class="tableblock">  number
</p><p class="tableblock">  alemesh_bc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces, edges, points</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">velocity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neumann_scalar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expr
</p><p class="tableblock">number
</p><p class="tableblock">alemesh_bc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">velocity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neumann_vectorial</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expr
</p><p class="tableblock">number
</p><p class="tableblock">alemesh_bc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">velocity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neumann_tensor2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expr
</p><p class="tableblock">number
</p><p class="tableblock">alemesh_bc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">velocity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">slip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">alemesh_bc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pressure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dirichlet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expr
</p><p class="tableblock">number
</p><p class="tableblock">alemesh_bc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fluid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outlet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number
</p><p class="tableblock">alemesh_bc
</p><p class="tableblock">model
</p><p class="tableblock">windkessel_coupling
</p><p class="tableblock">windkessel_Rd
</p><p class="tableblock">windkessel_Rp
</p><p class="tableblock">windkessel_Cd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fluid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inlet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expr
</p><p class="tableblock">shape
</p><p class="tableblock">constraint
</p><p class="tableblock">number
</p><p class="tableblock">alemesh_bc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_volumic_forces">Volumic forces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Body forces are also defined in <code>BoundaryConditions</code> category in json file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;VolumicForces&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;&lt;marker&gt;&quot;</span><span class="tok-p">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;{0,0,-gravityCst*7850}:gravityCst&quot;</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The marker corresponds to mesh elements marked with this tag.
If the marker is an empty string, it corresponds to all elements of the mesh.</p>
</div>
<div class="sect2">
<h3 id="_post_processing">Post Processing</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;PostProcess&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;Fields&quot;</span><span class="tok-p">:[</span><span class="tok-s2">&quot;field1&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;field2&quot;</span><span class="tok-p">,</span><span class="tok-err">...</span><span class="tok-p">],</span>
    <span class="tok-nt">&quot;Measures&quot;</span><span class="tok-p">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;&lt;measure type&gt;&quot;</span><span class="tok-p">:</span>
        <span class="tok-p">{</span>
            <span class="tok-nt">&quot;label&quot;</span><span class="tok-p">:</span>
            <span class="tok-p">{</span>
                <span class="tok-nt">&quot;&lt;range type&gt;&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;value&quot;</span><span class="tok-p">,</span>
                <span class="tok-nt">&quot;fields&quot;</span><span class="tok-p">:[</span><span class="tok-s2">&quot;field1&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;field3&quot;</span><span class="tok-p">]</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_exports_for_vizualisation">Exports for vizualisation</h4>
<div class="paragraph">
<p>The fields allowed to be exported in the <code>Fields</code> section are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>velocity</p>
</li>
<li>
<p>pressure</p>
</li>
<li>
<p>displacement</p>
</li>
<li>
<p>vorticity</p>
</li>
<li>
<p>stress or normal-stress</p>
</li>
<li>
<p>wall-shear-stress</p>
</li>
<li>
<p>density</p>
</li>
<li>
<p>viscosity</p>
</li>
<li>
<p>pid</p>
</li>
<li>
<p>alemesh</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_measures">Measures</h4>
<div class="ulist">
<ul>
<li>
<p>Points</p>
</li>
<li>
<p>Force</p>
</li>
<li>
<p>FlowRate</p>
</li>
<li>
<p>Pressure</p>
</li>
<li>
<p>VelocityDivergence</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_points">Points</h5>
<div class="paragraph">
<p>In order to evaluate velocity or pressure at specific points and save the results in .csv file, the user must define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"&lt;tag&gt;" representing this data in the .csv file</p>
</li>
<li>
<p>the coordinate of point</p>
</li>
<li>
<p>the fields evaluated ("pressure" or "velocity")</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Points&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
  <span class="tok-nt">&quot;&lt;tag&gt;&quot;</span><span class="tok-p">:</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;coord&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;{0.6,0.2,0}&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;fields&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;pressure&quot;</span>
  <span class="tok-p">},</span>
 <span class="tok-nt">&quot;&lt;tag&gt;&quot;</span><span class="tok-p">:</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;coord&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;{0.15,0.2,0}&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;fields&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;velocity&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_flow_rate">Flow rate</h5>
<div class="paragraph">
<p>The flow rate can be evaluated and save on .csv file.
The user must define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"&lt;tag&gt;" representing this data in the .csv file</p>
</li>
<li>
<p>"&lt;face_marker&gt;" representing the name of marked face</p>
</li>
<li>
<p>the fluid direction ("interior_normal" or "exterior_normal") of the flow rate.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;FlowRate&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;&lt;tag&gt;&quot;</span><span class="tok-p">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;markers&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;&lt;face_marker&gt;&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;direction&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;interior_normal&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;&lt;tag&gt;&quot;</span><span class="tok-p">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;markers&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;&lt;face_marker&gt;&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;direction&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;exterior_normal&quot;</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_forces">Forces</h5>
<div class="paragraph">
<p>compute lift and drag</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Forces&quot;</span><span class="tok-err">:</span><span class="tok-p">[</span><span class="tok-s2">&quot;fsi-wall&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;fluid-cylinder&quot;</span><span class="tok-p">]</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_export_user_functions">Export user functions</h4>
<div class="paragraph">
<p>A function defined by a symbolic expression can be represented as a finite element field thanks to nodal projection.
This function can be exported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Functions&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;toto&quot;</span><span class="tok-p">:{</span> <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;x*y:x:y&quot;</span><span class="tok-p">},</span>
    <span class="tok-nt">&quot;toto2&quot;</span><span class="tok-p">:{</span> <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;0.5*ubar*x*y:x:y:ubar&quot;</span><span class="tok-p">},</span>
    <span class="tok-nt">&quot;totoV&quot;</span><span class="tok-p">:{</span> <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;{2*x,y}:x:y&quot;</span><span class="tok-p">}</span>
<span class="tok-p">}</span><span class="tok-err">,</span>
<span class="tok-s2">&quot;PostProcess&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
   <span class="tok-nt">&quot;Fields&quot;</span><span class="tok-p">:[</span><span class="tok-s2">&quot;velocity&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;pressure&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;pid&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;totoV&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;toto&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;toto2&quot;</span><span class="tok-p">],</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_action_2">Action</h3>
<div class="paragraph">
<p>Let&#8217;s finish with a simple example in order to show how this works.
We will interest us to a fluid flow into a cavity in 3D.</p>
</div>
<div class="sect3">
<h4 id="_feel_code_2">Feel++ code</h4>
<div class="paragraph">
<p>Here is the code</p>
</div>
<div class="paragraph">
<p>First at all, we define our model type with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>typedef FeelModels::FluidMechanics&lt; Simplex&lt;FEELPP_DIM,1&gt;,
                                    Lagrange&lt;OrderVelocity,Vectorial,Continuous,PointSetFekete&gt;,
                                    Lagrange&lt;OrderPressure,Scalar,Continuous,PointSetFekete&gt; &gt; model_type;</pre>
</div>
</div>
<div class="paragraph">
<p>We choose here a \(\mathbb{P}_2\) space for the velocity order and
\(\mathbb{P}_1\) space for the pressure order. This definition allows us to
create our fluid model object FM like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre>auto FM = model_type::New("fluid");</pre>
</div>
</div>
<div class="paragraph">
<p>The method <code>New</code> retrieves all data from the configuration and json files and build a mesh if needed.</p>
</div>
<div class="paragraph">
<p>With this object, we can initialize our model parameters, such as velocity or
boundaries conditions. Data on our model and on the numeric solver are then
save and print on the terminal. This is made by</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FM-&gt;init();
FM-&gt;printAndSaveInfo();</pre>
</div>
</div>
<div class="paragraph">
<p>Now that our model is completed, we can solve the associated problem. To begin the resolution</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FM-&gt;isStationary()</pre>
</div>
</div>
<div class="paragraph">
<p>determine if our model is stationary or not.</p>
</div>
<div class="paragraph">
<p>If it is, then we need to solve our system only one time and export the obtained results.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FM-&gt;solve();
FM-&gt;exportResults();</pre>
</div>
</div>
<div class="paragraph">
<p>If it&#8217;s not, our model is time reliant, and a loop on time is necessary. Our model is then solve and the results are export at each time step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> for ( ; !FM-&gt;timeStepBase()-&gt;isFinished(); FM-&gt;updateTimeStep() )
        {
            FM-&gt;solve();
            FM-&gt;exportResults();
        }</pre>
</div>
</div>
<div class="sect4">
<h5 id="_code_4">Code</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cpp"><span class="tok-p">{</span><span class="tok-o">%</span> <span class="tok-n">include</span> <span class="tok-s">&quot;../Examples/fluid_model.cpp&quot;</span> <span class="tok-o">%</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_file_2">Configuration file</h4>
<div class="paragraph">
<p>The config file is used to define options,  linked to our case, we would have the possibility to change at will. It can be, for example, files paths as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[fluid]
geofile=$cfgdir/cavity3d.geo
filename=$cfgdir/cavity3d.json

[exporter]
directory=applications/models/fluid/cavity3d/$fluid_tag</pre>
</div>
</div>
<div class="paragraph">
<p>It can also be resolution dependent parameters such as mesh elements size, methods used  to define our problem and solvers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[fluid]
solver=Oseen #Picard,Newton

linearsystem-cst-update=false
jacobian-linear-update=false

snes-monitor=true
snes-maxit=100
snes-maxit-reuse=100
snes-ksp-maxit=1000
snes-ksp-maxit-reuse=100

pc-type=lu #gasm,lu,fieldsplit,ilu</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, we use Oseen to define our problem, we set the update of linear system constant and jacobian linear as "no update", we discretize values associated to SNES ( Scalable Nonlinear Equations Solvers ), and finally we choose LU as the preconditioner method.</p>
</div>
<div class="sect4">
<h5 id="_code_5">Code</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span class="tok-na">{% include &quot;../Examples/cavity3d.cfg&quot; %}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_json_file_3">Json file</h4>
<div class="paragraph">
<p>First at all, we define some general information like the name ( and short name ) and the model we would like to use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Name&quot;</span><span class="tok-err">:</span> <span class="tok-s2">&quot;Fluid Mechanics&quot;</span><span class="tok-err">,</span>
<span class="tok-s2">&quot;ShortName&quot;</span><span class="tok-err">:</span><span class="tok-s2">&quot;Fluid&quot;</span><span class="tok-err">,</span>
<span class="tok-s2">&quot;Model&quot;</span><span class="tok-err">:</span><span class="tok-s2">&quot;Navier-Stokes&quot;</span><span class="tok-err">,</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we define the <a href="#Material">material properties</a>. In our case, the fluid, define  by rho` its density in kg\cdot m^{-3} and <code>mu</code> its dynamic viscosity in kg\cdot (m \cdot s)^{-1}, is the only material we have to define.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Materials&quot;</span><span class="tok-err">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;Fluid&quot;</span><span class="tok-p">:{</span>
            <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myFluidMat&quot;</span><span class="tok-p">,</span>
            <span class="tok-nt">&quot;rho&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;1.0&quot;</span><span class="tok-p">,</span>
            <span class="tok-nt">&quot;mu&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;0.01&quot;</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span><span class="tok-err">,</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#Boundary_Conditions">boundary conditions</a> are the next aspect we define. Here, we impose on the velocity \(u_f\) Dirichlet conditions at two specific places : <code>lid</code> and <code>wall</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;BoundaryConditions&quot;</span><span class="tok-err">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;velocity&quot;</span><span class="tok-p">:</span>
        <span class="tok-p">{</span>
            <span class="tok-nt">&quot;Dirichlet&quot;</span><span class="tok-p">:</span>
            <span class="tok-p">{</span>
                <span class="tok-nt">&quot;lid&quot;</span><span class="tok-p">:</span>
                <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;{ 1,0,0}:x:y:z&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-nt">&quot;wall&quot;</span><span class="tok-p">:</span>
                <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;expr&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;{0,0,0}&quot;</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#Post_Process">post process</a> aspect is the last one to define. We choose the fields we want to export ( velocity, pressure and pid ). Furthermore, we want to measure forces on <code>wall</code> and the pressure at point \(A\).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;PostProcess&quot;</span><span class="tok-err">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;Fields&quot;</span><span class="tok-p">:[</span><span class="tok-s2">&quot;velocity&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;pressure&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;pid&quot;</span><span class="tok-p">],</span>
        <span class="tok-nt">&quot;Measures&quot;</span><span class="tok-p">:</span>
        <span class="tok-p">{</span>
            <span class="tok-nt">&quot;Forces&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;wall&quot;</span><span class="tok-p">,</span>
            <span class="tok-nt">&quot;Points&quot;</span><span class="tok-p">:</span>
            <span class="tok-p">{</span>
                <span class="tok-nt">&quot;pointA&quot;</span><span class="tok-p">:</span>
                <span class="tok-p">{</span>
                    <span class="tok-nt">&quot;coord&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;{0.5,0.5,0.5}&quot;</span><span class="tok-p">,</span>
                    <span class="tok-nt">&quot;fields&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;pressure&quot;</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
<span class="tok-err">}</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_code_6">Code</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-p">{</span><span class="tok-err">%</span> <span class="tok-err">include</span> <span class="tok-nt">&quot;../Examples/cavity3d.json&quot;</span> <span class="tok-err">%</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compilation_execution_2">Compilation/Execution</h4>
<div class="paragraph">
<p>Once you&#8217;ve a build dir, you just have to realise the command <code>make</code> at</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{buildir}/applications/models/fluid</pre>
</div>
</div>
<div class="paragraph">
<p>This will generate executables named <code>feelpp_application_fluid_*</code>. To execute it, you need to give the path of the cfg file associated to your case, with <code>--config-file</code>.</p>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./feelpp_application_fluid_3d --config-file={sourcedir}/applications/models/fluid/cavity/cavity3d.cfg</pre>
</div>
</div>
<div class="paragraph">
<p>is how to execute the case ahead.</p>
</div>
<div class="paragraph">
<p>The result files are then stored by default in</p>
</div>
<div class="listingblock">
<div class="content">
<pre> feel/applications/models/fluid/{case_name}/
   {velocity_space}{pression_space}{Geometric_order}/{processor_used}</pre>
</div>
</div>
<div class="paragraph">
<p>If we return once again at our example, the result files are in</p>
</div>
<div class="listingblock">
<div class="content">
<pre> feel/applications/models/fluid/cavity3d/P2P1G1/np_1</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<h1 id="_computational_solid_mechanics_toolbox" class="sect0">Computational Solid Mechanics Toolbox</h1>
<div id="toc" class="toc2">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_advection_models">Advection Models</a>
<ul class="sectlevel1">
<li><a href="#_json_file">JSON file</a>
<ul class="sectlevel2">
<li><a href="#_properties">Properties</a></li>
<li><a href="#_boundary_conditions">Boundary Conditions</a></li>
</ul>
</li>
<li><a href="#_action">Action</a>
<ul class="sectlevel2">
<li><a href="#_feel_code">Feel++ code</a></li>
<li><a href="#_configuration_file">Configuration file</a></li>
<li><a href="#_json_file_2">Json file</a></li>
<li><a href="#_compilation_execution">Compilation/Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_computational_fluid_mechanics_toolbox">Computational Fluid Mechanics Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_notations_and_units">Notations and units</a></li>
<li><a href="#_Équations">Équations</a></li>
<li><a href="#_materials">Materials</a>
<ul class="sectlevel2">
<li><a href="#_generalised_newtonian_fluid">Generalised Newtonian fluid</a></li>
<li><a href="#_boundary_conditions_2">Boundary Conditions</a></li>
<li><a href="#_neumann">Neumann</a></li>
<li><a href="#_slip">Slip</a></li>
<li><a href="#_inlet">Inlet</a></li>
<li><a href="#_outlet_flow">Outlet flow</a></li>
<li><a href="#_implementation_of_boundary_conditions_in_json">Implementation of boundary conditions in json</a></li>
<li><a href="#_options_summary">Options summary</a></li>
</ul>
</li>
<li><a href="#_volumic_forces">Volumic forces</a>
<ul class="sectlevel2">
<li><a href="#_post_processing">Post Processing</a></li>
<li><a href="#_action_2">Action</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_computational_solid_mechanics_toolbox">Computational Solid Mechanics Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_notations">Notations</a></li>
<li><a href="#_models">Models</a>
<ul class="sectlevel2">
<li><a href="#_linear_elasticity">Linear elasticity</a></li>
<li><a href="#_hyper_elasticity">Hyper-elasticity</a></li>
</ul>
</li>
<li><a href="#_materials_2">Materials</a></li>
<li><a href="#_boundary_conditions_3">Boundary Conditions</a></li>
<li><a href="#_volumic_forces_2">Volumic forces</a></li>
<li><a href="#_post_process">Post Process</a>
<ul class="sectlevel2">
<li><a href="#_exports_for_visualisation">Exports for visualisation</a></li>
<li><a href="#_measures_2">Measures</a></li>
</ul>
</li>
<li><a href="#_action_3">Action</a>
<ul class="sectlevel2">
<li><a href="#_feel_code_3">Feel++ code</a></li>
<li><a href="#_configuration_file_3">Configuration file</a></li>
<li><a href="#_json_file_4">Json file</a></li>
<li><a href="#_compilation_execution_3">Compilation/Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_fluid_structure_interaction_models">Fluid Structure Interaction Models</a>
<ul class="sectlevel1">
<li><a href="#_models_2">Models</a></li>
<li><a href="#_fluid_structure_coupling_conditions">Fluid structure coupling conditions</a>
<ul class="sectlevel2">
<li><a href="#_fluid_structure_coupling_conditions_with_1d_reduced_model">Fluid structure coupling conditions with 1D reduced model</a></li>
<li><a href="#_variables_symbols_and_units">Variables, symbols and units</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_thermo_electric_toolbox">Thermo-Electric Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_electrostatic_problem">Electrostatic problem</a></li>
<li><a href="#_heat_transfer_problem">Heat transfer problem</a></li>
<li><a href="#_thermo_electric_problem">Thermo-Electric problem</a></li>
<li><a href="#_running_the_thermo_electric_application">Running the Thermo-electric application</a></li>
</ul>
</li>
<li><a href="#_maxwell_equations">Maxwell Equations</a></li>
<li><a href="#_maxwell_s_equations">Maxwell&#8217;s equations</a>
<ul class="sectlevel1">
<li><a href="#_differential_form_of_maxwell_equations">Differential form of Maxwell equations</a>
<ul class="sectlevel2">
<li><a href="#_variables_symbols_and_units_2">Variables, symbols and units</a></li>
<li><a href="#_constitutive_relations">Constitutive relations</a></li>
<li><a href="#_classification_of_maxwell_s_equations">Classification of Maxwell&#8217;s Equations</a></li>
</ul>
</li>
<li><a href="#_magnetostatic_problem_formulation">Magnetostatic problem formulation</a></li>
<li><a href="#_vector_potential_formulation_for_magnetostatic">Vector Potential formulation for magnetostatic</a>
<ul class="sectlevel2">
<li><a href="#_benchmark">Benchmark</a></li>
<li><a href="#_regularized_point_system">Regularized point system</a></li>
<li><a href="#_saddle_point_system">Saddle point system</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_resolution_strategy">Resolution strategy</a>
<ul class="sectlevel1">
<li><a href="#_polarisation_method">Polarisation method</a>
<ul class="sectlevel2">
<li><a href="#_abstract_fixed_point_iteration">Abstract fixed point iteration</a></li>
<li><a href="#_fixed_point_iteration_for_the_a_formulation">Fixed point iteration for the A formulation</a></li>
</ul>
</li>
<li><a href="#_picard_method">Picard method</a></li>
<li><a href="#_linking_picard_to_the_polarization">Linking Picard to the Polarization</a></li>
<li><a href="#_formulations">Formulations</a>
<ul class="sectlevel2">
<li><a href="#_saddle_point_formulation">Saddle-point formulation</a></li>
<li><a href="#_regularized_formulation">Regularized formulation</a></li>
</ul>
</li>
<li><a href="#_solver_and_preconditionner">Solver and Preconditionner</a>
<ul class="sectlevel2">
<li><a href="#_outer_solver">Outer solver</a></li>
<li><a href="#_inner_solver">Inner solver</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_torus_benchmark">Torus Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description">Description</a>
<ul class="sectlevel2">
<li><a href="#_boundary_conditions_4">Boundary conditions</a></li>
</ul>
</li>
<li><a href="#_inputs">Inputs</a></li>
<li><a href="#_outputs">Outputs</a></li>
<li><a href="#_discretization_3">Discretization</a></li>
<li><a href="#_implementation">Implementation</a></li>
<li><a href="#_results">Results</a>
<ul class="sectlevel2">
<li><a href="#_potential_vector">Potential vector</a></li>
<li><a href="#_magnetic_flux">Magnetic flux</a></li>
</ul>
</li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</li>
<li><a href="#_inductor_benchmark">Inductor Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description_2">Description</a>
<ul class="sectlevel2">
<li><a href="#_geometry">Geometry</a></li>
<li><a href="#_magnetic_permeability">Magnetic permeability</a></li>
<li><a href="#_boundary_conditions_5">Boundary conditions</a></li>
</ul>
</li>
<li><a href="#_inputs_2">Inputs</a></li>
<li><a href="#_outputs_2">Outputs</a></li>
<li><a href="#_discretization_4">Discretization</a></li>
<li><a href="#_results_2">Results</a>
<ul class="sectlevel2">
<li><a href="#_linear_simulations">Linear simulations</a></li>
<li><a href="#_non_linear_simulations">Non linear simulations</a></li>
</ul>
</li>
<li><a href="#_conclusion_2">Conclusion</a></li>
</ul>
</li>
<li><a href="#_team_workshop_13_benchmark">Team Workshop 13 Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description_3">Description</a>
<ul class="sectlevel2">
<li><a href="#_geometry_2">Geometry</a></li>
<li><a href="#_magnetic_permeability_2">Magnetic permeability</a></li>
</ul>
</li>
<li><a href="#_inputs_3">Inputs</a></li>
<li><a href="#_outputs_3">Outputs</a></li>
<li><a href="#_behavior">Behavior</a>
<ul class="sectlevel2">
<li><a href="#_getdp_non_linear_curve">GetDP non linear curve</a></li>
<li><a href="#_intermediate_non_linear_curve">Intermediate non linear curve</a></li>
<li><a href="#_team_workshop_13_non_linear_curve">TEAM Workshop 13 non linear curve</a></li>
</ul>
</li>
<li><a href="#_comparision_with_team_workshop_13">Comparision with Team Workshop 13</a></li>
<li><a href="#_remarks">Remarks</a></li>
<li><a href="#_propositions">Propositions</a>
<ul class="sectlevel2">
<li><a href="#_polarization">Polarization</a></li>
<li><a href="#_continuity">Continuity</a></li>
<li><a href="#_mixing_polarization_and_picard">Mixing Polarization and Picard.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_notations">Notations</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>strain tensor \(\boldsymbol{F}_s = \boldsymbol{I} + \nabla \boldsymbol{\eta}_s\)</p>
</li>
<li>
<p>Cauchy-Green tensor \(\boldsymbol{C}_s = \boldsymbol{F}_s^{T} \boldsymbol{F}_s\)</p>
</li>
<li>
<p>Green-Lagrange tensor

\begin{align}
  \boldsymbol{E}_s &amp;= \frac{1}{2} \left( \boldsymbol{C}_s - \boldsymbol{I} \right)  \\
   &amp;= \underbrace{\frac{1}{2} \left( \nabla \boldsymbol{\eta}_s + \left(\nabla
   \boldsymbol{\eta}_s\right)^{T} \right)}_{\boldsymbol{\epsilon}_s}
  + \underbrace{\frac{1}{2} \left(\left(\nabla \boldsymbol{\eta}_s\right)^{T}
  \nabla \boldsymbol{\eta}_s \right)}_{\boldsymbol{\gamma}_s}
\end{align}
</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quantity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\rho_s\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">density</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(kg.m^{-3}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\lambda_s\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">first Lamé coefficients</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(N.m^{-2}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mu_s\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">second Lamé coefficients</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(N.m^{-2}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(E_s\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Young modulus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(kg.m^{-1}.s^{-2}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\nu_s\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Poisson&#8217;s ratio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dimensionless</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_models">Models</h2>
<div class="sectionbody">
<div class="stemblock">
<div class="content">
\[  \rho^*_{s} \frac{\partial^2 \boldsymbol{\eta}_s}{\partial t^2}
  - \nabla \cdot \left(\boldsymbol{F}_s \boldsymbol{\Sigma}_s\right)
  =    \boldsymbol{f}^t_s\]
</div>
</div>
<div class="sect2">
<h3 id="_linear_elasticity">Linear elasticity</h3>
<div class="paragraph">
<p>
\begin{align}
\boldsymbol{F}_s &amp;= \text{Identity} \\
\boldsymbol{\Sigma}_s &amp;=\lambda_s tr( \boldsymbol{\epsilon}_s)\boldsymbol{I} +
2\mu_s\boldsymbol{\epsilon}_s
\end{align}
</p>
</div>
</div>
<div class="sect2">
<h3 id="_hyper_elasticity">Hyper-elasticity</h3>
<div class="sect3">
<h4 id="_saint_venant_kirchhoff">Saint-Venant-Kirchhoff</h4>
<div class="stemblock">
<div class="content">
\[\boldsymbol{\Sigma}_s=\lambda_s tr( \boldsymbol{E}_s)\boldsymbol{I} +
2\mu_s\boldsymbol{E}_s\]
</div>
</div>
</div>
<div class="sect3">
<h4 id="_neo_hookean">Neo-Hookean</h4>
<div class="stemblock">
<div class="content">
\[\boldsymbol{\Sigma}_s= \mu_s J^{-2/3}(\boldsymbol{I} - \frac{1}{3}
\text{tr}(\boldsymbol{C}) \ \boldsymbol{C}^{-1})\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\boldsymbol{\Sigma}_s^ = \boldsymbol{\Sigma}_s^\text{iso} +
\boldsymbol{\Sigma}_s^\text{vol}\]
</div>
</div>
<div class="sect4">
<h5 id="_isochoric_part_boldsymbol_sigma_s_text_iso">Isochoric part : \boldsymbol{\Sigma}_s^\text{iso}</h5>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. Isochoric law</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">\(\mathcal{W}_S(J_s)\)</th>
<th class="tableblock halign-left valign-top">\(\boldsymbol{\Sigma}_s^{\text{iso}}\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neo-Hookean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mu_s J^{-2/3}(\boldsymbol{I} - \frac{1}{3} \text{tr}(\boldsymbol{C}) \ \boldsymbol{C}^{-1}) \)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_volumetric_part_boldsymbol_sigma_s_text_vol">Volumetric part : \(\boldsymbol{\Sigma}_s^\text{vol}\)</h5>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. Volumetric law</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">\(\mathcal{W}_S(J_s)\)</th>
<th class="tableblock halign-left valign-top">\(\boldsymbol{\Sigma}_s^\text{vol}\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">classic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\frac{\kappa}{2} \left( J_s - 1 \right)^2\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">simo1985</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\frac{\kappa}{2} \left( ln(J_s) \right)\)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The solid mechanics model can be selected in json file :</p>
</div>
<div class="listingblock">
<div class="title">Listing : select solid model</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Model&quot;</span><span class="tok-err">:</span><span class="tok-s2">&quot;Hyper-Elasticity&quot;</span></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 12. Table of Models for <code>model</code> option</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Model</th>
<th class="tableblock halign-left valign-top">Name in json</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linear Elasticity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Elasticity</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hyper Elasticity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Hyper-Elasticity</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When materials are closed to incompressibility formulation in
displacement/pressure are available.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 13. Table of Models for <code>material_law</code> with hyper elasticity model</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Model</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Volumic law</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Saint-Venant-Kirchhoff</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SaintVenantKirchhoff</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">classic, simo1985</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NeoHookean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NeoHookean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">classic, simo1985</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>option: <code>mechanicalproperties.compressible.volumic_law</code></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_materials_2">Materials</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">Materials section</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Materials&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;&lt;marker&gt;&quot;</span><span class="tok-p">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;solid&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;E&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;1.4e6&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;nu&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;0.4&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;rho&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;1e3&quot;</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>E</code> stands for the Young&#8217;s modulus in Pa, <code>nu</code> the Poisson&#8217;s ratio (
dimensionless ) and <code>rho</code> the density in kg\cdot m^{-3}.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_boundary_conditions_3">Boundary Conditions</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 14. Boundary conditions</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dirichlet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">faces, edges and component-wise</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Dirichlet"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neumann</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scalar, vectorial</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Neumann_scalar" or "Neumann_vectorial"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pressure follower ,</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nonlinear boundary condition set in deformed domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TODO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Robin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TODO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TODO</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_volumic_forces_2">Volumic forces</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 15. Volumic forces</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vectorial</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"VolumicForces"</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_post_process">Post Process</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exports_for_visualisation">Exports for visualisation</h3>
<div class="paragraph">
<p>The fields allowed to be exported in the <code>Fields</code> section are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>displacement</p>
</li>
<li>
<p>velocity</p>
</li>
<li>
<p>acceleration</p>
</li>
<li>
<p>stress or normal-stress</p>
</li>
<li>
<p>pressure</p>
</li>
<li>
<p>material-properties</p>
</li>
<li>
<p>pid</p>
</li>
<li>
<p>fsi</p>
</li>
<li>
<p>Von-Mises</p>
</li>
<li>
<p>Tresca</p>
</li>
<li>
<p>principal-stresses</p>
</li>
<li>
<p>all</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_measures_2">Measures</h3>
<div class="ulist">
<ul>
<li>
<p>Points</p>
</li>
<li>
<p>Maximum</p>
</li>
<li>
<p>Minimum</p>
</li>
<li>
<p>VolumeVariation</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_points_2">Points</h4>
<div class="paragraph">
<p>Same syntax as FluidMechanics with available Fields :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>displacement</p>
</li>
<li>
<p>velocity</p>
</li>
<li>
<p>acceleration</p>
</li>
<li>
<p>pressure</p>
</li>
<li>
<p>principal-stress-0</p>
</li>
<li>
<p>principal-stress-1</p>
</li>
<li>
<p>principal-stress-2</p>
</li>
<li>
<p>sigma_xx, sigma_xy, &#8230;&#8203;</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_maximum_minimum">Maximum/Minimum</h4>
<div class="paragraph">
<p>The Maximum and minimum can be evaluated and save on .csv file. User need to define (i) &lt;Type&gt; ("Maximum" or "Minimum"),
(ii) "&lt;tag&gt;" representing this data in the .csv file, (iii) "&lt;marker&gt;" representing the name of marked entities and (iv) the field where extremum is computed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;&lt;Type&gt;&quot;</span><span class="tok-err">:</span>
<span class="tok-p">{</span>
    <span class="tok-nt">&quot;&lt;tag&gt;&quot;</span><span class="tok-p">:</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;markers&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;marker&gt;&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;fields&quot;</span><span class="tok-p">:[</span><span class="tok-s2">&quot;displacement&quot;</span><span class="tok-p">,</span><span class="tok-s2">&quot;velocity&quot;</span><span class="tok-p">]</span>
    <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_volumevariation">VolumeVariation</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;VolumeVariation&quot;</span><span class="tok-err">:&lt;marker&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_action_3">Action</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s finish with a simple example in order to show how this works and how to use them. We will interest us to the deformation of an elastic structure.</p>
</div>
<div class="sect2">
<h3 id="_feel_code_3">Feel++ code</h3>
<div class="paragraph">
<p>First at all, we define our model type with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>typedef FeelModels::SolidMechanics&lt; Simplex&lt;FEELPP_DIM,1&gt;,
                                    Lagrange&lt;OrderDisp, Vectorial,Continuous,PointSetFekete&gt; &gt; model_type;</pre>
</div>
</div>
<div class="paragraph">
<p>We choose here \mathbb{P}_1 space for displacement order. This definition
allows us to create our fluid model object SM like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre>auto SM = model_type::New("solid");</pre>
</div>
</div>
<div class="paragraph">
<p>The method <code>New</code> retrieve all data from the configuration and json files, as well build a mesh if need.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SM-&gt;isStationary()</pre>
</div>
</div>
<div class="paragraph">
<p>will determine if our model is stationary or not.</p>
</div>
<div class="paragraph">
<p>If it isn&#8217;t, our model is time reliant, and a loop on time is necessary. We then solve our problem and export the results at each time step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    {
        SM-&gt;init();
        SM-&gt;printAndSaveInfo();

        for ( ; !SM-&gt;timeStepBase()-&gt;isFinished(); SM-&gt;updateTimeStep() )
        {
            SM-&gt;solve();
            SM-&gt;exportResults();
        }
    }</pre>
</div>
</div>
<div class="paragraph">
<p>If it is stationary, we need to check if we are in quasi static mode or not.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bool algoQuasiStatic = boption(_name="solve-quasi-static");</pre>
</div>
</div>
<div class="paragraph">
<p>If not, we save and print our model and solvers. Then the system is solve and we can export the results.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>if ( !algoQuasiStatic )
        {
            SM-&gt;init();
            SM-&gt;printAndSaveInfo();
            SM-&gt;solve();
            SM-&gt;exportResults();
        }</pre>
</div>
</div>
<div class="sect3">
<h4 id="_code_7">Code</h4>
<div class="paragraph">
<p>Here is the code</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cpp"><span class="tok-p">{</span><span class="tok-o">%</span> <span class="tok-n">include</span> <span class="tok-s">&quot;../Examples/solid_model.cpp&quot;</span> <span class="tok-o">%</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_file_3">Configuration file</h3>
<div class="paragraph">
<p>The config file is used to define options  linked to our case we would have the possibility to change at will. It can be, for example, files paths as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[solid]
filename=$top_srcdir/applications/models/solid/TurekHron/csm3.json

# precondtioner config
geofile=$top_srcdir/applications/models/solid/TurekHron/csm.geo

[exporter]
directory=applications/models/solid/TurekHron/csm3/$solid_tag</pre>
</div>
</div>
<div class="paragraph">
<p>It can also be resolution dependent parameters such as mesh elements size, methods used  to define our problem and solvers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[solid]

material_law=StVenantKirchhoff# StVenantKirchhoff, NeoHookean

# use density and material coeff cst in appli
jacobian-linear-update=false
linearsystem-cst-update=false

# snes and ksp config
#reuse-prec=true#false
#reuse-jac=true#false
reuse-jac.rebuild-at-first-newton-step=true
reuse-prec.rebuild-at-first-newton-step=true
snes-maxit=500
snes-maxit-reuse=10
snes-ksp-maxit=1000
snes-ksp-maxit-reuse=100

# precondtioner config
pc-type=lu #lu,gasm,ml
ksp-converged-reason=1</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, we use the Saint-Venant-Kirchhoff model to  define our problem, we set the update of linear system constant and jacobian linear as "no update", we discretize values associated to solvers ( SNES and KSP ), and finally we choose LU as the preconditioner method.</p>
</div>
<div class="sect3">
<h4 id="_code_8">Code</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span class="tok-na">{% include &quot;../Examples/csm3.cfg&quot; %}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_json_file_4">Json file</h3>
<div class="paragraph">
<p>First at all, we define some general information like the name ( and short name ) and the model we would like to use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-s2">&quot;Name&quot;</span><span class="tok-err">:</span> <span class="tok-s2">&quot;Solid Mechanics &quot;</span><span class="tok-err">,</span>
<span class="tok-s2">&quot;ShortName&quot;</span><span class="tok-err">:</span><span class="tok-s2">&quot;Solid&quot;</span><span class="tok-err">,</span>
<span class="tok-s2">&quot;Model&quot;</span><span class="tok-err">:</span><span class="tok-s2">&quot;Hyper-Elasticity&quot;</span><span class="tok-err">,</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we define parameters we will need to solve our problem. Here we define a gravitational constant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"Parameters":
    {
        "gravity":
        {
            "value":"2"
        }
    },</pre>
</div>
</div>
<div class="paragraph">
<p>After that, we define the <a href="#Material">material properties</a>. In our case, we
define the solid we will study, named beam here, by E, \nu and
\rho, respectively its Young&#8217;s modulus ( kg/ms^2 ), its Poisson&#8217;s ratio
( dimensionless ) and its density (in kg/m^3)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-err">Materials</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">    {</span>
<span class="tok-s2">        &quot;</span><span class="tok-err">beam</span><span class="tok-s2">&quot;:{</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">name</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-err">solid</span><span class="tok-s2">&quot;,</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">E</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-mf">1.4e6</span><span class="tok-s2">&quot;,</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">nu</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-mf">0.4</span><span class="tok-s2">&quot;,</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">rho</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-mf">1e3</span><span class="tok-err">&quot;</span>
        <span class="tok-err">}</span>
    <span class="tok-err">},</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#Boundary_Conditions">boundary conditions</a> are the next aspect we define. Here, we impose on the displacement several conditions :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Dirichlet condition on fixed wall</p>
</li>
<li>
<p>A Neumann condition on free wall</p>
</li>
<li>
<p>A volumic force, represent here by the action of the gravity on the solid.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-err">BoundaryConditions</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">    {</span>
<span class="tok-s2">        &quot;</span><span class="tok-err">displacement</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">        {</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">Dirichlet</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">            {</span>
<span class="tok-s2">                &quot;</span><span class="tok-err">fixed-wall</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">                {</span>
<span class="tok-s2">                    &quot;</span><span class="tok-err">expr</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-p">{</span><span class="tok-err">0,0</span><span class="tok-p">}</span><span class="tok-s2">&quot;</span>
<span class="tok-s2">                }</span>
<span class="tok-s2">            },</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">Neumann_scalar</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">            {</span>
<span class="tok-s2">                &quot;</span><span class="tok-err">free-wall</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">                {</span>
<span class="tok-s2">                    &quot;</span><span class="tok-err">expr</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-mi">0</span><span class="tok-s2">&quot;</span>
<span class="tok-s2">                }</span>
<span class="tok-s2">            },</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">VolumicForces</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">            {</span>
<span class="tok-s2">                &quot;&quot;:</span>
<span class="tok-s2">                {</span>
<span class="tok-s2">                    &quot;</span><span class="tok-err">expr</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-p">{</span><span class="tok-err">0,-gravity*1e3</span><span class="tok-p">}</span><span class="tok-err">:gravity&quot;</span>
                <span class="tok-err">}</span>
            <span class="tok-err">}</span>
        <span class="tok-err">}</span>
    <span class="tok-err">},</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#Post_Process">post process</a> aspect is the last one to define. We want
to export displacement values as well as measure displacement and velocity on
point A along with the maximum of this values on all the free wall.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-err">PostProcess</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">    {</span>
<span class="tok-s2">        &quot;</span><span class="tok-err">Fields</span><span class="tok-s2">&quot;:[&quot;</span><span class="tok-err">displacement</span><span class="tok-s2">&quot;],</span>
<span class="tok-s2">        &quot;</span><span class="tok-err">Measures</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">        {</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">Points</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">            {</span>
<span class="tok-s2">                &quot;</span><span class="tok-err">pointA</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">                {</span>
<span class="tok-s2">                    &quot;</span><span class="tok-err">coord</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-p">{</span><span class="tok-err">0.6,0.2,0</span><span class="tok-p">}</span><span class="tok-s2">&quot;,</span>
<span class="tok-s2">                    &quot;</span><span class="tok-err">fields</span><span class="tok-s2">&quot;:[&quot;</span><span class="tok-err">displacement</span><span class="tok-s2">&quot;,&quot;</span><span class="tok-err">velocity</span><span class="tok-s2">&quot;]</span>
<span class="tok-s2">                }</span>
<span class="tok-s2">            },</span>
<span class="tok-s2">            &quot;</span><span class="tok-err">Maximum</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">            {</span>
<span class="tok-s2">                &quot;</span><span class="tok-err">free-wall</span><span class="tok-s2">&quot;:</span>
<span class="tok-s2">                {</span>
<span class="tok-s2">                    &quot;</span><span class="tok-err">markers</span><span class="tok-s2">&quot;:&quot;</span><span class="tok-err">free-wall</span><span class="tok-s2">&quot;,</span>
<span class="tok-s2">                    &quot;</span><span class="tok-err">fields</span><span class="tok-s2">&quot;:[&quot;</span><span class="tok-err">displacement</span><span class="tok-s2">&quot;,&quot;</span><span class="tok-err">velocity&quot;]</span>
                <span class="tok-err">}</span>
            <span class="tok-err">}</span>
        <span class="tok-err">}</span>
    <span class="tok-err">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_code_9">Code</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cfg"><span class="tok-na">{% include &quot;../Examples/csm3.json&quot; %}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compilation_execution_3">Compilation/Execution</h3>
<div class="paragraph">
<p>Once you&#8217;ve a build dir, you just have to realise the command <code>make</code> at</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{buildir}/applications/models/solid</pre>
</div>
</div>
<div class="paragraph">
<p>This will generate executables named <code>feelpp_application_solid_*</code>. To execute it, you need to give the path of the cfg file associated to your case, with <code>--config-file</code>.</p>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mpirun -np 4 feelpp_application_fluid_2d --config-file={sourcedir}/applications/models/solid/TurekHron/csm3.cfg</pre>
</div>
</div>
<div class="paragraph">
<p>is how to execute the case ahead on 4 processors.</p>
</div>
<div class="paragraph">
<p>The result files are then stored by default in</p>
</div>
<div class="listingblock">
<div class="content">
<pre>feel/applications/models/solid/{case_name}/{OrderDis}{Geometric_order}/{processor_used}</pre>
</div>
</div>
<div class="paragraph">
<p>If we return once again at the example, they are in</p>
</div>
<div class="listingblock">
<div class="content">
<pre>feel/applications/models/solid/TurekHron/csm3/P1G1/np_8</pre>
</div>
</div>
</div>
</div>
</div>
<h1 id="_fluid_structure_interaction_models" class="sect0">Fluid Structure Interaction Models</h1>
<div class="paragraph">
<p>The Fluid Structure models are formed from the combination of a <a href="../Solid/README.adoc">Solid model</a> and a <a href="../Fluid/README.adoc">Fluid model</a>.</p>
</div>
<div class="sect1">
<h2 id="_models_2">Models</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_fluid_structure_coupling_conditions">Fluid structure coupling conditions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to have a correct fluid-structure model, we need to add to the solid model and the fluid model equations some coupling conditions :</p>
</div>
<div class="stemblock">
<div class="content">
\[  \frac{\partial \boldsymbol{\eta_{s}} }{\partial t} - \boldsymbol{u}_f \circ \mathcal{A}_{f}^t
  = \boldsymbol{0} , \quad \text{ on } \Gamma_{fsi}^* \times \left[t_i,t_f \right] \quad \boldsymbol{(1)}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[  \boldsymbol{F}_{s} \boldsymbol{\Sigma}_{s} \boldsymbol{n}^*_s + J_{\mathcal{A}_{f}^t} \hat{\boldsymbol{\sigma}}_f \boldsymbol{F}_{\mathcal{A}_{f}^t}^{-T} \boldsymbol{n}^*_f
  = \boldsymbol{0} , \quad \text{ on } \Gamma_{fsi}^* \times \left[t_i,t_f \right] \quad \boldsymbol{(2)}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[  \boldsymbol{\varphi}_s^t  - \mathcal{A}_{f}^t = \boldsymbol{0} , \quad \text{ on } \Gamma_{fsi}^* \times \left[t_i,t_f \right] \quad \boldsymbol{(3)}\]
</div>
</div>
<div class="paragraph">
<p>\(\boldsymbol{(1)}, \boldsymbol{(2)}, \boldsymbol{(3)}\) are the fluid-struture coupling conditions, respectively velocities continuity, constraint continuity and geometric continuity.</p>
</div>
<div class="sect2">
<h3 id="_fluid_structure_coupling_conditions_with_1d_reduced_model">Fluid structure coupling conditions with 1D reduced model</h3>
<div class="paragraph">
<p>For the <a href="FSIModel.adoc#_fluid_structure_coupling_conditions">coupling conditions</a>, between the 2D fluid and 1D structure, we need to modify the original ones  \boldsymbol{(1)},\boldsymbol{(2)}, \boldsymbol{(3)}  by</p>
</div>
<div class="stemblock">
<div class="content">
\[\dot{\eta}_s \boldsymbol{e}_r - \boldsymbol{u}_f = \boldsymbol{0} \quad \boldsymbol{(1.2)}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[f_s  + \left(J_{\mathcal{A}_f^t} \boldsymbol{F}_{\mathcal{A}_f^t}^{-T} \hat{\boldsymbol{\sigma}}_f \boldsymbol{n}^*_f\right) \cdot \boldsymbol{e}_r
=  0 \quad \boldsymbol{(2.2)}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\boldsymbol{\varphi}_s^t  - \mathcal{A}_f^t = \boldsymbol{0} \quad \boldsymbol{(3.2)}\]
</div>
</div>
</div>
<div class="sect2">
<h3 id="_variables_symbols_and_units">Variables, symbols and units</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quantity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{u}_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fluid velocity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(m.s^{-1}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{\sigma}_f\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fluid stress tensor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(N.m^{-2}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{\eta}_s\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">displacement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(m\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{F}_s\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deformation gradient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dimensionless</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\boldsymbol{\Sigma}_s\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">second Piola-Kirchhoff tensor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(N.m^{-2}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mathcal{A}_f^t\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arbitrary Lagrangian Eulerian ( ALE ) map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dimensionless</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>and</p>
</div>
<div class="stemblock">
<div class="content">
\[\boldsymbol{F}_{\mathcal{A}_f^t} = \boldsymbol{\mathrm{x}}^* + \nabla \mathcal{A}_f^t\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[J_{\mathcal{A}_f^t} = det(\boldsymbol{F}_{\mathcal{A}_f^t})\]
</div>
</div>
</div>
</div>
</div>
<h1 id="_thermo_electric_toolbox" class="sect0">Thermo-Electric Toolbox</h1>
<div id="toc" class="toc2">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_advection_models">Advection Models</a>
<ul class="sectlevel1">
<li><a href="#_json_file">JSON file</a>
<ul class="sectlevel2">
<li><a href="#_properties">Properties</a></li>
<li><a href="#_boundary_conditions">Boundary Conditions</a></li>
</ul>
</li>
<li><a href="#_action">Action</a>
<ul class="sectlevel2">
<li><a href="#_feel_code">Feel++ code</a></li>
<li><a href="#_configuration_file">Configuration file</a></li>
<li><a href="#_json_file_2">Json file</a></li>
<li><a href="#_compilation_execution">Compilation/Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_computational_fluid_mechanics_toolbox">Computational Fluid Mechanics Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_notations_and_units">Notations and units</a></li>
<li><a href="#_Équations">Équations</a></li>
<li><a href="#_materials">Materials</a>
<ul class="sectlevel2">
<li><a href="#_generalised_newtonian_fluid">Generalised Newtonian fluid</a></li>
<li><a href="#_boundary_conditions_2">Boundary Conditions</a></li>
<li><a href="#_neumann">Neumann</a></li>
<li><a href="#_slip">Slip</a></li>
<li><a href="#_inlet">Inlet</a></li>
<li><a href="#_outlet_flow">Outlet flow</a></li>
<li><a href="#_implementation_of_boundary_conditions_in_json">Implementation of boundary conditions in json</a></li>
<li><a href="#_options_summary">Options summary</a></li>
</ul>
</li>
<li><a href="#_volumic_forces">Volumic forces</a>
<ul class="sectlevel2">
<li><a href="#_post_processing">Post Processing</a></li>
<li><a href="#_action_2">Action</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_computational_solid_mechanics_toolbox">Computational Solid Mechanics Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_notations">Notations</a></li>
<li><a href="#_models">Models</a>
<ul class="sectlevel2">
<li><a href="#_linear_elasticity">Linear elasticity</a></li>
<li><a href="#_hyper_elasticity">Hyper-elasticity</a></li>
</ul>
</li>
<li><a href="#_materials_2">Materials</a></li>
<li><a href="#_boundary_conditions_3">Boundary Conditions</a></li>
<li><a href="#_volumic_forces_2">Volumic forces</a></li>
<li><a href="#_post_process">Post Process</a>
<ul class="sectlevel2">
<li><a href="#_exports_for_visualisation">Exports for visualisation</a></li>
<li><a href="#_measures_2">Measures</a></li>
</ul>
</li>
<li><a href="#_action_3">Action</a>
<ul class="sectlevel2">
<li><a href="#_feel_code_3">Feel++ code</a></li>
<li><a href="#_configuration_file_3">Configuration file</a></li>
<li><a href="#_json_file_4">Json file</a></li>
<li><a href="#_compilation_execution_3">Compilation/Execution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_fluid_structure_interaction_models">Fluid Structure Interaction Models</a>
<ul class="sectlevel1">
<li><a href="#_models_2">Models</a></li>
<li><a href="#_fluid_structure_coupling_conditions">Fluid structure coupling conditions</a>
<ul class="sectlevel2">
<li><a href="#_fluid_structure_coupling_conditions_with_1d_reduced_model">Fluid structure coupling conditions with 1D reduced model</a></li>
<li><a href="#_variables_symbols_and_units">Variables, symbols and units</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_thermo_electric_toolbox">Thermo-Electric Toolbox</a>
<ul class="sectlevel1">
<li><a href="#_electrostatic_problem">Electrostatic problem</a></li>
<li><a href="#_heat_transfer_problem">Heat transfer problem</a></li>
<li><a href="#_thermo_electric_problem">Thermo-Electric problem</a></li>
<li><a href="#_running_the_thermo_electric_application">Running the Thermo-electric application</a></li>
</ul>
</li>
<li><a href="#_maxwell_equations">Maxwell Equations</a></li>
<li><a href="#_maxwell_s_equations">Maxwell&#8217;s equations</a>
<ul class="sectlevel1">
<li><a href="#_differential_form_of_maxwell_equations">Differential form of Maxwell equations</a>
<ul class="sectlevel2">
<li><a href="#_variables_symbols_and_units_2">Variables, symbols and units</a></li>
<li><a href="#_constitutive_relations">Constitutive relations</a></li>
<li><a href="#_classification_of_maxwell_s_equations">Classification of Maxwell&#8217;s Equations</a></li>
</ul>
</li>
<li><a href="#_magnetostatic_problem_formulation">Magnetostatic problem formulation</a></li>
<li><a href="#_vector_potential_formulation_for_magnetostatic">Vector Potential formulation for magnetostatic</a>
<ul class="sectlevel2">
<li><a href="#_benchmark">Benchmark</a></li>
<li><a href="#_regularized_point_system">Regularized point system</a></li>
<li><a href="#_saddle_point_system">Saddle point system</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_resolution_strategy">Resolution strategy</a>
<ul class="sectlevel1">
<li><a href="#_polarisation_method">Polarisation method</a>
<ul class="sectlevel2">
<li><a href="#_abstract_fixed_point_iteration">Abstract fixed point iteration</a></li>
<li><a href="#_fixed_point_iteration_for_the_a_formulation">Fixed point iteration for the A formulation</a></li>
</ul>
</li>
<li><a href="#_picard_method">Picard method</a></li>
<li><a href="#_linking_picard_to_the_polarization">Linking Picard to the Polarization</a></li>
<li><a href="#_formulations">Formulations</a>
<ul class="sectlevel2">
<li><a href="#_saddle_point_formulation">Saddle-point formulation</a></li>
<li><a href="#_regularized_formulation">Regularized formulation</a></li>
</ul>
</li>
<li><a href="#_solver_and_preconditionner">Solver and Preconditionner</a>
<ul class="sectlevel2">
<li><a href="#_outer_solver">Outer solver</a></li>
<li><a href="#_inner_solver">Inner solver</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_torus_benchmark">Torus Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description">Description</a>
<ul class="sectlevel2">
<li><a href="#_boundary_conditions_4">Boundary conditions</a></li>
</ul>
</li>
<li><a href="#_inputs">Inputs</a></li>
<li><a href="#_outputs">Outputs</a></li>
<li><a href="#_discretization_3">Discretization</a></li>
<li><a href="#_implementation">Implementation</a></li>
<li><a href="#_results">Results</a>
<ul class="sectlevel2">
<li><a href="#_potential_vector">Potential vector</a></li>
<li><a href="#_magnetic_flux">Magnetic flux</a></li>
</ul>
</li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</li>
<li><a href="#_inductor_benchmark">Inductor Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description_2">Description</a>
<ul class="sectlevel2">
<li><a href="#_geometry">Geometry</a></li>
<li><a href="#_magnetic_permeability">Magnetic permeability</a></li>
<li><a href="#_boundary_conditions_5">Boundary conditions</a></li>
</ul>
</li>
<li><a href="#_inputs_2">Inputs</a></li>
<li><a href="#_outputs_2">Outputs</a></li>
<li><a href="#_discretization_4">Discretization</a></li>
<li><a href="#_results_2">Results</a>
<ul class="sectlevel2">
<li><a href="#_linear_simulations">Linear simulations</a></li>
<li><a href="#_non_linear_simulations">Non linear simulations</a></li>
</ul>
</li>
<li><a href="#_conclusion_2">Conclusion</a></li>
</ul>
</li>
<li><a href="#_team_workshop_13_benchmark">Team Workshop 13 Benchmark</a>
<ul class="sectlevel1">
<li><a href="#_description_3">Description</a>
<ul class="sectlevel2">
<li><a href="#_geometry_2">Geometry</a></li>
<li><a href="#_magnetic_permeability_2">Magnetic permeability</a></li>
</ul>
</li>
<li><a href="#_inputs_3">Inputs</a></li>
<li><a href="#_outputs_3">Outputs</a></li>
<li><a href="#_behavior">Behavior</a>
<ul class="sectlevel2">
<li><a href="#_getdp_non_linear_curve">GetDP non linear curve</a></li>
<li><a href="#_intermediate_non_linear_curve">Intermediate non linear curve</a></li>
<li><a href="#_team_workshop_13_non_linear_curve">TEAM Workshop 13 non linear curve</a></li>
</ul>
</li>
<li><a href="#_comparision_with_team_workshop_13">Comparision with Team Workshop 13</a></li>
<li><a href="#_remarks">Remarks</a></li>
<li><a href="#_propositions">Propositions</a>
<ul class="sectlevel2">
<li><a href="#_polarization">Polarization</a></li>
<li><a href="#_continuity">Continuity</a></li>
<li><a href="#_mixing_polarization_and_picard">Mixing Polarization and Picard.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section focuses on defining and solving of a thermo-electric model, which couples heat transfer and electrostatic models.
The current flow inside an electrical conductor leads to the heating of the material, due to Joule effect.
The temperature in the conductor can be deduced from the standard heat equation whose source term reads from the electrical potential to mimic the Joule effect.</p>
</div>
<div class="paragraph">
<p>In the following sections, the domain is denoted by \(\Omega \subset \mathbb{R}^d\), \(d=2,3\) and its border by \(\Gamma\).</p>
</div>
<div class="sect1">
<h2 id="_electrostatic_problem">Electrostatic problem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The electrostatic model consists in a diffusion equation. The electrical potential \(V\) satisfies</p>
</div>
<div class="stemblock">
<div class="content">
\[\nabla\cdot(-\sigma\nabla V) = 0 ~~\text{in}~~ \Omega\]
</div>
</div>
<div class="paragraph">
<p>where \(\sigma\) is the electrical conductivity.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The electrical conductivity \(\sigma\) often depends on the temperature. The thermo-electric model becomes non-linear in this case.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The current flow within the conductor is modeled by a difference in electrical potential between the current input \(\Gamma_{in} \subset \Gamma\) and the current output \(\Gamma_{out} \subset \Gamma\).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(V=0 ~~\text{on}~~ \Gamma_{in}\)</p>
</li>
<li>
<p>\(V=V_{out} ~~\text{on}~~ \Gamma_{out}\).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We consider in this model that all other boundaries are electrically insulating. This conditions reads from the current density \(\mathbf{j} = - \sigma \nabla V\) as</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(\mathbf{j}\cdot\mathbf{n} = -\sigma\nabla V\cdot\mathbf{n} = 0 ~~\text{on}~~ \Gamma  \setminus (\Gamma_{in} \cup \Gamma_{out})\).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The local form of Joule&#8217;s law defines the heat source corresponding to Joule effect as the dot product of the current density \(\mathbf{j} = - \sigma \nabla V\) by the electric field \(E=-\nabla V\).
This product \(P = \sigma \nabla V \cdot \nabla V\) will be the source term of the heat equation defined in the next section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_heat_transfer_problem">Heat transfer problem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The temperature \(T\) satisfies the standard heat equation with the previously introduced Joule effect as source term,</p>
</div>
<div class="stemblock">
<div class="content">
\[\nabla\cdot(-k\nabla T) = \sigma\nabla V\cdot \nabla V ~~\text{in}~~ \Omega\]
</div>
</div>
<div class="paragraph">
<p>where \(k\) is the thermal conductivity.<br></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As for the electrical conductivity \(\sigma\), the thermal conductivity \(k\) can also depends on temperature.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The thermal flux can eventually be controled by a water cooling process which limit the heating.
The thermal exchange between the electrical conductor and the cooling water is governed by a convection phenomenon involving a heat transfert coefficient \(h\) and the water temperature \(T_c\).
This cooling process is handled by a Robin condition on the cooled regions \(\Gamma_{c} \subset \Gamma\)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(-k\nabla T\cdot\mathbf{n} = h(T-T_c) ~~\text{on}~~ \Gamma_{C}\)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We consider that the thermal exchanges are limited to the cooled region, which amounts to apply an homogeneous Neumann condition on all other boundaries.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(-k\nabla T\cdot \mathbf{n} = 0 ~~\text{on}~~ \Gamma \setminus \Gamma_{C}\)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_thermo_electric_problem">Thermo-Electric problem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the thermo-electric model, we have 4 parameters</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(\sigma\) the electrical conductivity</p>
</li>
<li>
<p>\(k\) the thermal conductivity</p>
</li>
<li>
<p>\(T_c\) the water cooling temperature</p>
</li>
<li>
<p>\(h\) the heat transfer coefficient</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These parameters can be scalars of fields.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We gather in the following table parameter ranges, nominal values as well as units for \(\sigma, k, T_c, h\).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 16. Table of parameters for the simulation</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ranges</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nominal value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Units</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\sigma\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\([52.10^{6};58.10^{6}\)]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(53\cdot 10^{6}\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(S \cdot m^{-1}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(k\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\([360;380\)]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(370\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(W\cdot m^{-1} \cdot K^{-1}$\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(T_c\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\([293;310\)]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(300\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(h\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\([70000;90000\)]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(850000\)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(W \cdot m^{-2} \cdot K^{-1}\)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the linear case, we first solve for \(V\) and then  for \(T\) using \(V\) to compute the Joule effect that generates heat inside \(\Omega\).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_thermo_electric_application">Running the Thermo-electric application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <a href="../02-docker/README.adoc">Docker</a>,
you can run Feel++ model application and in particular the thermo-electric model using the following command</p>
</div>
<div class="listingblock">
<div class="title">Docker command</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ docker run -it -v $HOME/feel:/feel feelpp/feelpp-toolboxes:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then type the following command in docker environment to run the model</p>
</div>
<div class="listingblock">
<div class="title">Running Thermo-Electric model</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="shell">$ cd Testcases/models/thermoelectric/test
$ mpirun -np 4 /usr/local/bin/feelpp_toolbox_thermoelectric_3d --config-file model.cfg</code></pre>
</div>
</div>
</div>
</div>
<h1 id="_maxwell_equations" class="sect0">Maxwell Equations</h1>
<div class="paragraph">
<p>Electromagnetic field  problems can be characterized by the field intensities and the flux densities described by the partial differential equations derived from Maxwell’s equations.</p>
</div>
<div class="paragraph">
<p>Maxwell’s equations define relations for the electromagnetic field quantities and the source elements, i.e. the electric and the magnetic field intensities, the electric and the magnetic flux densities, the charge and current distribution. Constitutive relations are added to Maxwell’s equations to describe the properties of the media.</p>
</div>
<h1 id="_maxwell_s_equations" class="sect0">Maxwell&#8217;s equations</h1>
<div class="paragraph">
<p>Presentation of the Maxwell equations.</p>
</div>
<div class="sect1">
<h2 id="_differential_form_of_maxwell_equations">Differential form of Maxwell equations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The differential form of Maxwell’s equations reads:
$$
\begin{aligned}
\nabla \times \mathbf{H}(\mathbf{x},t) &amp;= \mathbf{J}(\mathbf{x},t) + \frac{\partial \mathbf{D}(\mathbf{x},t)}{\partial t}\\</p>
</div>
<div class="paragraph">
<p>\nabla \times \mathbf{E}(\mathbf{x},t) &amp; = - \frac{\partial \mathbf{B}(\mathbf{x},t)}{\partial t}\\</p>
</div>
<div class="paragraph">
<p>\nabla \cdot \mathbf{B}(\mathbf{x},t) &amp; = 0\\</p>
</div>
<div class="paragraph">
<p>\nabla \cdot \mathbf{D}(\mathbf{x},t) &amp; = \rho(\mathbf{x},t)\\</p>
</div>
<div class="paragraph">
<p>\mathbf{B}(\mathbf{x},t) &amp;= \mu_0[\mathbf{H}(\mathbf{x}, t) + \mathbf{M}(\mathbf{x}, t)],\\</p>
</div>
<div class="paragraph">
<p>\mathbf{J}(\mathbf{x},t) &amp;= \sigma[\mathbf{E}(\mathbf{x}, t) + \mathbf{E}_i(\mathbf{x}, t)] = \sigma \mathbf{E}(\mathbf{x}, t) + \mathbf{J}_i(\mathbf{x}, t)\\</p>
</div>
<div class="paragraph">
<p>\mathbf{D}(\mathbf{x},t) &amp; = \epsilon_0 \mathbf{E}(\mathbf{x}, t) + \mathbf{P}(\mathbf{x}, t)
\end{aligned}
$$</p>
</div>
<div class="sect2">
<h3 id="_variables_symbols_and_units_2">Variables, symbols and units</h3>
<div class="paragraph">
<p>The following table provides the names and units (in SI) of the symbols and variables above.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 17. Name and units of symbols and variables of the Maxwell&#8217;s equations</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Notation</th>
<th class="tableblock halign-left valign-top">Quantity</th>
<th class="tableblock halign-left valign-top">Unit</th>
<th class="tableblock halign-left valign-top">SI</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{H}(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">magnetic field intensity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot m^{-1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot m^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{E}(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">electric field intensity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V\cdot m^{-1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg\cdot m \cdot s^{-3}\cdot A^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{B}(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">magnetic flux density</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg\cdot s^{-2}\cdot A^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{D}(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">electric flux density</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C\cdot m^{-2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot s\cdot m^{-2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{A}(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">magnetic potential vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V\cdot s\cdot m^{-1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg\cdot m \cdot s^{-2}\cdot A^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{J}(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">electric current density</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot m^{-2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot m^{-2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\rho(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">electric charge density</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C\cdot m^{-3}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot s\cdot m^{-3}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{M}(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">magnetisation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot m^{-1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot m^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{E}_i(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">impressed electric  field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V\cdot m^{-1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg\cdot m \cdot s^{-3}\cdot A^{-1}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{J}_i(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">impressed electric  current</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot m^{-2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot m^{-2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mathbf{P}(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">polarization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C\cdot m^{-2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A\cdot s\cdot m^{-2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\mu_0(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">permeability of vacuum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H\cdot m^{-1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg\cdot m\cdot s^{-2}\cdot A^{-2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\sigma(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conductivity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S\cdot m^{-1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg^{-1}\cdot m^{-3}\cdot s^3\cdot A^2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\epsilon_0(\mathbf{x},t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">permittivity of vacuum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F\cdot m^{-1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kg^{-1}\cdot m^{-3}\cdot s^4\cdot A^2</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The field quantities are depending on space \mathbf{x} and on time t, we will omit later both in the notation and use e.g. \mathbf{H}, \mathbf{E}, \ldots</p>
</div>
<div class="paragraph">
<p>The sources of the electromagnetic fields are the electric current density \mathbf{J} and the electric charge density \rho.</p>
</div>
</div>
<div class="sect2">
<h3 id="_constitutive_relations">Constitutive relations</h3>
<div class="paragraph">
<p>The last three equations in Maxwell&#8217;s equations above collect the constitutive relations, which – depending on the properties of the examined material – describe the relationship between field quantities.</p>
</div>
<div class="paragraph">
<p>In the simplest case these relations are linear, i.e.

\mathbf{M} = \chi\mathbf{H},\quad \mathbf{E}_i=0,\quad \mathbf{P}=\epsilon_0\chi_d\mathbf{E}
</p>
</div>
<div class="paragraph">
<p>where \chi and \chi_d are the <strong>magnetic</strong> and the <strong>dielectric susceptibility</strong> respectively and

\mathbf{B} = \mu \mathbf{H},\quad
\mathbf{J} = \sigma \mathbf{E}, \quad
\mathbf{D} = \epsilon_0 \mathbf{E}

where

\mu = \mu_0(1 + \chi) = \mu_0\mu_r,\quad \epsilon = \epsilon_0(1 + \chi_d) = \epsilon_0\epsilon_r.

Here \mu_r = 1 + \chi is the relative permeability, \epsilon_r = 1 + \chi_d is the relative permittivity of the material and the conductivity \sigma is constant. The equation \mathbf{J} = \sigma \mathbf{E} is the differential form of Ohm’s law.</p>
</div>
<div class="paragraph">
<p>The constitutive relations are  nonlinear in general, that is the permeability,  conductivity and  permittivity depend on the associated field quantities, i.e.

\mu = \mu(\mathbf{H},\mathbf{B}),\quad \sigma = \sigma(\mathbf{E}, \mathbf{J}),\quad \epsilon = \epsilon(\mathbf{E}, \mathbf{D})

or equivalently

\mathbf{B} = \mathcal{B}(\mathbf{H}),\quad \mathbf{J} = \mathcal{J}(\mathbf{E}),\quad \mathbf{D} = \mathcal{D}(\mathbf{E})

where \mathcal{B}(·), \mathcal{J}(·) \text{ and } \mathcal{D}(·) are operators. We would actually need also the inverse operator, e.g.

\mathbf{H} = \mathcal{B}^{-1}(\mathbf{B})
</p>
</div>
</div>
<div class="sect2">
<h3 id="_classification_of_maxwell_s_equations">Classification of Maxwell&#8217;s Equations</h3>
<div class="paragraph">
<p>We now turn to the classification of the Maxwell’s equations.</p>
</div>
<div class="paragraph">
<div class="title">Steady case</div>
<p>The simplest case corresponds to the steady case:  the time variation of the field quantities can be neglected, i.e. \partial/\partial t = 0. The corresponding fields are called <strong>static field</strong>. In this case the magnetic, the electric and the current fields can be treated independently because there are no interactions between them.</p>
</div>
<div class="paragraph">
<div class="title">Time varying case</div>
<p>When ∂/∂t ̸= 0, the magnetic and electric fields are coupled, we are then in the presence of eddy current fields and wave propagation of electrodynamics.</p>
</div>
<div class="sect3">
<h4 id="_static_magnetic_field">Static magnetic field</h4>
<div class="paragraph">
<p>The time independent current density \mathbf{J} = \mathbf{J}(\mathbf{x}) generates the time independent magnetic field intensity \mathbf{H} = \mathbf{H}(\mathbf{x}) and the time independent magnetic flux density \mathbf{B} = \mathbf{B}(\mathbf{x}).</p>
</div>
<div class="paragraph">
<p>the magnetostatic Maxwell&#8217;s equations read
$$
\begin{aligned}
\nabla \times \mathbf{H}(\mathbf{x}) &amp;= \mathbf{J}(\mathbf{x}) \\</p>
</div>
<div class="paragraph">
<p>\nabla \cdot \mathbf{B}(\mathbf{x}) &amp; = 0\\</p>
</div>
<div class="paragraph">
<p>\mathbf{B}(\mathbf{x}) &amp;=
\begin{cases}
\mu_0 \mathbf{H}\,&amp; \text{ in air}\\
\mu_0\mu_r \mathbf{H}\,&amp; \text{ in magnetically linear media}\\
\mu_0[\mathbf{H} + \mathbf{M}]\,&amp; \text{ in magnetically nonlinear media}
\end{cases}
\end{aligned}
$$</p>
</div>
<div class="paragraph">
<p>In a nonlinear medium, the magnetization vector \mathbf{M} = \mathbf{M}(\mathbf{x}) is depending on the magnetic field intensity vector, i.e. \mathbf{M} = \mathcal{H}(\mathbf{H}). The operator \mathcal{H} can be described by so-called <strong>hysteresis</strong> models denoted by \mathbf{B} = \mathcal{B}(\mathbf{H}).</p>
</div>
<div class="paragraph">
<p>This constitutive relation has an inverse form which read

\mathbf{H} =
\begin{cases}
\nu_0 \mathbf{B}\,&amp; \text{ in air}\\
\nu_0\nu_r \mathbf{B}\,&amp; \text{ in magnetically linear media}\\
\mathcal{B}^{-1}(\mathbf{B})\,&amp; \text{ in magnetically nonlinear media}
\end{cases}

where \nu_0 = 1/\mu_0,\, \nu_r = 1/\mu_r are the <strong>reluctivity of vacuum</strong> and the <strong>relative reluctivity</strong>.
In magnetically nonlinear media, it can be represented by an inverse hysteresis operator, \mathbf{H} = \mathcal{B}^{-1}(\mathbf{B}).</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> Note that the source current distribution is <strong>solenoidal</strong>, which reads \nabla \cdot \mathbf{J} = 0 (take the divergence of the first Maxwell&#8217;s equation).
This means that all current lines either close upon themselves, or start and terminate at infinity.</p>
</div>
</blockquote>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> This case corresponds to magnetic fields generated by <strong>(i)</strong> coils carrying currents or <strong>(ii)</strong> the static behavior of electrical machines. When \mathbf{J}=0, then a boundary value problem  to simulate e.g. the field of magnetic poles.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_magnetostatic_problem_formulation">Magnetostatic problem formulation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Denote \Omega_0 the non-magnetic (e.g. air) part of \Omega (hence 0) and \Omega_m the magnetic part.</p>
</div>
<div class="paragraph">
<p>In the case of static magnetic field, the Maxwell&#8217;s equations read</p>
</div>
<div class="paragraph">
<p>$$
\begin{aligned}
\nabla \times \mathbf{H}(\mathbf{x}) &amp;= \mathbf{J}(\mathbf{x}) \text{ in } \Omega_0 \cup \Omega_m\\</p>
</div>
<div class="paragraph">
<p>\nabla \cdot \mathbf{B}(\mathbf{x}) &amp; = 0 \text{ in } \Omega_0 \cup \Omega_m\\</p>
</div>
<div class="paragraph">
<p>\mathbf{B}(\mathbf{x}) &amp;=
\begin{cases}
\mu_0 \mathbf{H}\,&amp; \text{ in air}\\
\mu_0\mu_r \mathbf{H}\,&amp; \text{ in magnetically linear media}\\
\mathcal{B}(\mathbf{H}) = \mu_{\mathrm{o}} \mathbf{H}\mathbf{R}\,&amp; \text{ in magnetically nonlinear media}
\end{cases}
\end{aligned}

The constitutive relation has an inverse form

\begin{aligned}
\mathbf{H}(\mathbf{x}) &amp;=
\begin{cases}
\nu_0 \mathbf{B}\,&amp; \text{ in air}\\
\nu_0\nu_r \mathbf{B}\,&amp; \text{ in magnetically linear media}\\
\mathcal{B}^{-1}(\mathbf{B}) = \nu_{\mathrm{o}} \mathbf{B}\mathbf{I}\,&amp; \text{ in magnetically nonlinear media}
\end{cases}
\end{aligned}
$$</p>
</div>
<div class="paragraph">
<p>where \mu_{\mathrm{o}} and \nu_{\mathrm{o}} are the optimal permeability and reluctivity respectively obtained using the polarisation method described <a href="#polar">below</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> Only the tangential components of \mathbf{H} is continuous across the interface \Gamma_{0m} between \Omega_0 and \Omega_m. As to \mathbf{B}, it is its normal component which is continuous across \Gamma_{0m}</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_potential_formulation_for_magnetostatic">Vector Potential formulation for magnetostatic</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The magnetic vector potential \mathbf{A} is defined by

\mathbf{B} = \nabla \times \mathbf{A}

which satisfies \nabla \cdot \mathbf{B} = 0 exactly, because of the identity \nabla \cdot \nabla \times \mathbf{v} = 0  for any vector function \mathbf{v}.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Warning</strong> To ensure the uniqueness of the magnetic vector potential, its divergence  can be selected according to Coulomb gauge,

\nabla \cdot \mathbf{A} = 0

This is useful, because the vector potential \mathbf{A}' = \mathbf{A} + \nabla \phi  also satisfies the equations above, because of the identity \nabla \times \nabla \phi = \mathbf{0} where \phi is a scalar field. This is the reason why the magnetic vector potential is not unique.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Substituting the definition of \mathbf{A}  into the first Maxwell’s equation and using the linearized constitutive relation, we get

\nabla \times (\nu_{\mathrm{o}} \nabla \times \mathbf{A} ) = \mathbf{J} - \nabla \times \mathbf{I}\quad \text{ in } \Omega

where \mathbf{J} is the source current density.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> In case where the media is linear, the term -\nabla\times\mathbf{I} disappears.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The strategy to solve this equation is discussed <a href="Strategy.adoc">here</a>.</p>
</div>
<div class="sect2">
<h3 id="_benchmark">Benchmark</h3>
<div class="paragraph">
<p>We benchmark here our implementation.</p>
</div>
<div class="paragraph">
<p>We set - for convenience - \mu_{\mathrm{o}} to one in that convergence test.</p>
</div>
<div class="paragraph">
<p>Given a sinusoïdal solution, we compute - with no regularization terms (we are not interested in the potential vector but its curl) - the appropriate right hand side and use the exact solution a boundary condition.</p>
</div>
<div class="paragraph">
<p>
\begin{equation}
\begin{aligned}
\mathbf{J}&amp;= \begin{pmatrix} 3 \pi^3 \cos(\pi x) \sin(\pi y)\sin(\pi z) \\ -6\pi^3 \sin(\pi x) \cos(\pi y) \sin(\pi z) \\ 3\pi^3 \sin(\pi x) \sin(\pi y) \cos(\pi z) \end{pmatrix} \\
\mathbf{A}_{exact}&amp;=\begin{pmatrix} \pi \cos(\pi  x) \sin(\pi y) \sin(\pi z)\\ -2\pi \sin(\pi x) \cos(\pi y) \sin(\pi z) \\ \pi \sin(\pi x) \sin(\pi y) \cos(\pi z)\end{pmatrix} \\
\mathbf{c}&amp;=\begin{pmatrix}3 \pi^2 \cos(\pi z) \cos(\pi y)\sin(\pi x)\\0 \\-(3\pi^2) \sin(\pi z) \cos(\pi y)\cos(\pi x )\end{pmatrix}
\end{aligned}
\end{equation}
</p>
</div>
</div>
<div class="sect2">
<h3 id="_regularized_point_system">Regularized point system</h3>
<div class="paragraph">
<p>
\begin{equation}
\begin{aligned}
\nabla \times \left(\frac{1}{\mu_{\mathrm{o}}} \nabla \times \mathbf{A} \right) + \epsilon \mathbf{A} &amp;= \mathbf{J} \quad \text{ in } \Omega \\
\left.\mathbf{A}\right|_{\partial \Omega} &amp;= \mathbf{A}_{exact} \\
\end{aligned}
\end{equation}
</p>
</div>
</div>
<div class="sect2">
<h3 id="_saddle_point_system">Saddle point system</h3>
<div class="paragraph">
<p>
\begin{equation}
\begin{aligned}
\nabla \times \left(\frac{1}{\mu_{\mathrm{o}}} \nabla \times \mathbf{A} \right) + \nabla p &amp;= \mathbf{J} \quad \text{ in } \Omega \\
\nabla \cdot \mathbf{A} &amp;= 0 \quad\text{ in } \Omega \\
\left.\mathbf{A}\right|_{\partial \Omega} &amp;= \mathbf{A}_{exact} \\
\left.p\right|_{\partial \Omega} &amp;= 0
\end{aligned}
\end{equation}

The boundary condition can apply with penalization or elimination.
We compare both results:
<span class="image"><img src="Figures/convergence_saddle.png" alt="Saddle Point system convergence"></span></p>
</div>
</div>
</div>
</div>
<h1 id="_resolution_strategy" class="sect0">Resolution strategy</h1>
<div class="paragraph">
<p>Resolution strategy for Maxwell equations</p>
</div>
<div class="sect1">
<h2 id="_polarisation_method">Polarisation method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Design and simulation of electrical engineering applications containing ferromagnetic parts require the accurate modeling of hysteresis characteristics and the implementation of the models and solve the nonlinear partial differential equations derived from Maxwell’s equations.</p>
</div>
<div class="paragraph">
<p>The partial differential equations are generally nonlinear because of the nonlinear characteristics of ferromagnetic materials.</p>
</div>
<div class="paragraph">
<p>The numerical analysis of electromagnetic fields can be characterized by the electric and magnetic field intensities and flux densities formulated by Maxwell’s equations, which are the collection of partial differential equations of the electric field intensity \mathbf{E}, the magnetic field intensity \mathbf{H}, the electric flux density \mathbf{D} and the magnetic flux density \mathbf{B}.</p>
</div>
<div class="paragraph">
<p>Constitutive relations between the above quantities are defined to take into account the macroscopic properties of the medium.</p>
</div>
<div class="paragraph">
<p>We consider a constitutive relation between the magnetic field intensity and the magnetic flux density which is nonlinear , given by the operator \mathbf{B} = \mathcal{B}(\mathbf{H}) or equivalently \mathbf{H} = \mathcal{B}^{−1}(\mathbf{B}). These nonlinear characteristics can be reformulated by introducing the <strong>polarization method</strong> and the resulting system of nonlinear equations can be solved using <strong>fixed point iterations</strong>.</p>
</div>
<div class="paragraph">
<p>According to the polarization method, the magnetic flux density can be split in two parts as

\mathbf{B} = \mu \mathbf{H} + \mathbf{R}

where \mu \mathbf{H} is a linear term, \mu is constant and the nonlinearity is in the second term \mathbf{R}. It is a magnetic flux density like quantity.</p>
</div>
<div class="paragraph">
<p>The question is the appropriate value of the parameter \mu. This representation can be reformulated as

\mathbf{R} = \mathbf{B}-\mu \mathbf{H} = \mathbf{B}-\mu \mathcal{B}^{-1}(\mathbf{B})

Here, the inverse type hysteresis characteristics are used.</p>
</div>
<div class="paragraph">
<p>It is important to note that the nonlinear equations are solved by iterative methods, the n-th iteration is denoted by the superscript (n) in the following.
By using the various formula in the constitutive relations defined in Maxwell’s equations, the solution of the nonlinear partial differential equations with appropriate boundary conditions can be formulated as

\mathbf{B}^{(n)} = \mathcal{M}(\mathbf{R}^{(n-1)})

where the operator \mathcal{M} represents the set of Maxwell’s equations and the boundary conditions. The starting \mathbf{R}^{(0)} is arbitrary. The value of electromagnetic field quantities in the n-th step are depending on the value of \mathbf{R} in the (n − 1)-th step and they represent source like quantities.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> The source of electromagnetic fields (e.g. the electric current density \mathbf{J}) is not changing during fixed point iteration, i.e. the fixed point iteration has no particular physical meaning.</p>
</div>
</blockquote>
</div>
<div class="sect2">
<h3 id="_abstract_fixed_point_iteration">Abstract fixed point iteration</h3>
<div class="paragraph">
<p>It may be better to use the reluctivity \nu when applying the inverse hysteresis model, because \nu(B) = \frac{\partial H}{\partial B}.
Let us now multiply the relation above by \nu_{\mathrm{o}} = 1/\mu_{\mathrm{o}}, we have

\nu_{\mathrm{o}} \mathbf{B} = \mathbf{H} + \nu_{\mathrm{o}}\mathbf{R},

hence

\mathbf{H} = \nu_{\mathrm{o}} \mathbf{B} - \nu_{\mathrm{o}}\mathbf{R}  = \nu_{\mathrm{o}} \mathbf{B} + \mathbf{I}

where \mathbf{I}= -\nu_{\mathrm{o}}\mathbf{R}, \nu_{\mathrm{o}}=\frac{\nu_{\mathrm{min}}+\nu_{\mathrm{max}}}{2} and \nu_{\mathrm{min}} and \nu_{\mathrm{max}} are the minimum and maximum slope of the inverse of the hysteresis characteristics. We have  \nu_{\mathrm{min}} = 1/\mu_{\mathrm{max}}  and \nu_{\mathrm{max}}=1/\mu_{\mathrm{min}}.</p>
</div>
<div class="paragraph">
<p>The nonlinear fixed point iteration can be summarized as follows.
The iteration can be started by an arbitrary value of \mathbf{I}^{(0)}, then for n &gt; 0 we do,</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>the magnetic flux density \mathbf{B}^{(n)} can be calculated by solving the partial differential equations obtained from Maxwell’s equations and using \mathbf{I}^{(n−1)}, in other words,

\mathbf{B}^{(n)} =\mathcal{M}({\mathbf{I}^{(n−1)}}),
</p>
</li>
<li>
<p>the magnetic field intensity \mathbf{H}^{(n)} can be calculated by applying the inverse type
hysteresis model, \mathbf{H}^{(n)} = \mathcal{B}^{−1}(\mathbf{B}^{(n)}),</p>
</li>
<li>
<p>the nonlinear residual term can be updated by using the magnetic flux density and
magnetic field intensity,

\mathbf{I}^{(n)} = \mathbf{H}^{(n)} − \nu_{\mathrm{o}} \mathbf{B}^{(n)} = \mathcal{B}^{−1}({\mathbf{B}^{(n)}}) − \nu_{\mathrm{o}} \mathbf{B}^{(n)}
</p>
</li>
<li>
<p>and the sequence defined by steps (i)–(iii) must be repeated until convergence.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Convergence criterion can be ||\mathbf{I}^{(n)} − \mathbf{I}^{(n−1)}|| &lt; \varepsilon, where \varepsilon is the tolerance. Convergence criterion can be also defined by using the magnetic field intensity or the magnetic flux density.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fixed_point_iteration_for_the_a_formulation">Fixed point iteration for the A formulation</h3>
<div class="paragraph">
<p>Recall that we have

\nabla \times (\nu_{\mathrm{o}} \nabla \times \mathbf{A} ) = \mathbf{J} - \nabla \times \mathbf{I}\quad \text{ in } \Omega

associated to proper boundary conditions for \mathbf{A}.
The fixed point iteration algorithm reads</p>
</div>
<div class="paragraph">
<p>We start with arbitrary \mathbf{I}^{(0)} and then for n &gt; 0</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>solve

\nabla \times (\nu_{\mathrm{o}} \nabla \times \mathbf{A}^{(n)} ) = \mathbf{J} - \nabla \times \mathbf{I}^{(n-1)}\quad \text{ in } \Omega
</p>
</li>
<li>
<p>compute

\mathbf{B}^{(n)}=\nabla \times \mathbf{A}^{(n)}
</p>
</li>
<li>
<p>compute the residual

\mathbf{I}^{(n)} = \mathcal{B}^{−1}({\mathbf{B}^{(n)}}) − \nu_{\mathrm{o}} \mathbf{B}^{(n)}
</p>
</li>
<li>
<p>repeat steps i-iii until convergence, e.g.

||\mathbf{I}^{(n)}-\mathbf{I}^{(n-1)}|| &lt; \varepsilon
</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_picard_method">Picard method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The main benefit for the polarization method is to keep the matrix constant.
There is no need to rebuild a preconditioner and to assemble again and again the matrix.
Actually, as long as the volume of the non linear concrete is small against the total volume, the gain is proportionnaly small.</p>
</div>
<div class="paragraph">
<p>Generaly, the non linear law links the magnetic field magnitude \mathbf{\| B\|}  to the magnetic field intensity \mathbf{\| H\|}. In other word, we have an isotropic concrete.
That is we have the relation B = \mu(H) H instead of \mathbf{\| B\|} = \mu(\mathbf{\| H\|}) \mathbf{H}.</p>
</div>
<div class="paragraph">
<p>One can write:

\begin{aligned}
B &amp;= \mu(H) H, \\
  &amp;= \mu_r \mu_0 H,
\end{aligned}

where \mu_r is the relative magnetic permeability.</p>
</div>
<div class="paragraph">
<p>We denote with \mu(H) the interpolation of the data.
It is defined thanks to a P_1 or Akima&#8217;s interpolation of the dataset B-\frac{H}{B}.</p>
</div>
<div class="paragraph">
<p>The Picard algorithm reads:</p>
</div>
<div class="paragraph">
<p>Given an initial \mu_r^{(0)} chosen arbitrarily:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>solve

\nabla \times \left(\frac{1}{\mu_r^{(n)}} \nabla \times \mathbf{A}^{(n)} \right) = \mu_0 \mathbf{J}\quad \text{ in } \Omega
</p>
</li>
<li>
<p>compute

B^{(n)}=\|\nabla \times \mathbf{A}^{(n)}\|
</p>
</li>
<li>
<p>compute

H^{(n)} = \frac{B^{(n)}}{\mu_0 \mu_r^{(n)}}
</p>
</li>
<li>
<p>compute

\mu_r^{(n+1)} = \frac{\mu(H^{(n)})}{\mu_0}
</p>
</li>
<li>
<p>repeat steps i-iii until convergence, e.g.

||\mathbf{B}^{(n)}-\mathbf{B}^{(n-1)}|| &lt; \varepsilon
</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_linking_picard_to_the_polarization">Linking Picard to the Polarization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The polarization method has some evident advantages.
Our benchmarks (to come) has shown that algorithm is less robust than the Picard one.</p>
</div>
<div class="paragraph">
<p>We note here an idea we do not have yet implemented that should circumvent the Polarization problem.</p>
</div>
<div class="paragraph">
<p>We want to transfer from the right hand side to the matrix the non linearity.
When a criteria we need to define is reached, we construct \mu_{N}

\begin{aligned}
B &amp;= \mu_0 \mu_{opt} H + I \\
  &amp;= \mu_0 \mu_{N} H \\
\mu_{N} &amp;= \mu_{opt} + \frac{1}{\mu_0} \frac{I}{H}
\end{aligned}

And then we start a new Polarization algorithm with an initial \mathbf{I} set to zero.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_formulations">Formulations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_saddle_point_formulation">Saddle-point formulation</h3>
<div class="paragraph">
<p>The first possibility is to add a constraint on the divergence using the Coulomb gauge,  \nabla \cdot \mathbf{A} = 0 . It is managed by a scalar Lagrange multiplier, giving the saddle-point problem:

\begin{aligned}
\nabla\times\nu_0\nabla\times\mathbf{A} + \nabla p &amp;= \mathbf{J} - \nabla\times\mathbf{I} &amp;\text{ in } \Omega\\
\nabla\cdot\mathbf{A} &amp;= 0 &amp;\text{ in } \Omega\\
\mathbf{A}\times\mathbf{n} &amp;= \mathbf{A}_D &amp;\text{ on } \partial\Omega\\
p &amp;= 0 &amp;\text{ on } \partial\Omega
\end{aligned}
</p>
</div>
<div class="sect3">
<h4 id="_variational_formulation">Variational formulation</h4>
<div class="paragraph">
<p>The variational formulation the consists in finding (\mathbf{A},p) \in ( X \subset H(\mathrm{curl},\Omega) \times H^1_0(\Omega)) (see <a href="../Appendix/Notations.adoc">Notations</a>) such that

\begin{aligned}
  &amp;\int_{\Omega}\nu_0(\nabla \times \mathbf{A}) \cdot (\nabla \times \mathbf{v})
    + \int_{\delta \Omega}\nu_0 (\nabla \times \mathbf{A}) \cdot (\mathbf{v} \times \mathbf{n})
    + \int_{\Omega} \mathbf{v} \cdot \nabla p = \int_{\Omega} \mathbf{J} \cdot \mathbf{v}- \int_{\Omega} (\nabla \times \mathbf{I})\cdot \mathbf{v} ~~\forall \mathbf{v}  \in Y \\
  &amp;\int_{\Omega} \mathbf{A} \cdot \nabla q = 0 ~~\forall q \in H^1_0(\Omega)
\end{aligned}
</p>
</div>
<div class="paragraph">
<p>The Dirichlet boundary condition on \mathbf{A} imposed on strong form vanishes the boundary term of and the condition is directly taken into account in the definition of the function space X = H_{\mathbf{A}_D}(\mathrm{curl},\Omega) = \{ \mathbf{v} \in H(\mathrm{curl},\Omega) \mid \mathbf{v} \times \mathbf{n} = \mathbf{A}_D ~\text{on} ~\partial \Omega\}. The variational formulation then consists in finding (\mathbf{A},p) \in ( H_{\mathbf{A}_D}(\mathrm{curl},\Omega) \times H^1_0(\Omega)) such that

\begin{aligned}
  &amp; \int_{\Omega}\nu_0(\nabla \times \mathbf{A}) \cdot (\nabla \times \mathbf{v})
    + \int_{\Omega} \mathbf{v} \cdot \nabla p = \int_{\Omega} \mathbf{J} \cdot \mathbf{v} - \int_{\Omega} (\nabla \times \mathbf{I})\cdot \mathbf{v}  ~~\forall \mathbf{v} \in H_{0}(\mathrm{curl},\Omega) \\
  &amp; \int_{\Omega} \mathbf{A} \cdot \nabla q = 0 ~~\forall q \in H^1_0(\Omega)
\end{aligned}

We can also impose the Dirichlet boundary conditions on weak form, adding symetrization and penalisation terms and then avoiding to add condition in X function space, i.e. X = H(\mathrm{curl},\Omega). As previously, \gamma is the penalisation coefficient and h_s the mesh size. The variational formulation consists then in finding \mathbf{A} \in H(\mathrm{curl},\Omega) such that \forall (\mathbf{v},q) \in H(\mathrm{curl},\Omega)\times H^1_0(\Omega)

\begin{align}
  \int_{\Omega}\nu(\nabla \times \mathbf{A}) \cdot (\nabla \times \mathbf{v})
  + \int_{\delta \Omega}\nu (\nabla \times \mathbf{A}) \cdot (\mathbf{v} \times \mathbf{n})&amp;\\
  + \int_{\delta \Omega}\nu (\nabla \times \mathbf{v}) \cdot (\mathbf{A} \times \mathbf{n})
  + \int_{\delta \Omega} \frac{\gamma}{h_s} \nu (\mathbf{v} \times \mathbf{n}) \cdot (\mathbf{A} \times \mathbf{n})&amp; \\
  + \int_{\Omega} \mathbf{v} \cdot \nabla p
  &amp;= \int_{\Omega} \mathbf{J} \cdot \mathbf{v}
  - \int_{\Omega} (\nabla \times \mathbf{I})\cdot \mathbf{v}\\
  &amp;+ \int_{\delta \Omega}\nu (\nabla \times \mathbf{v}) \cdot \mathbf{A}_D
  + \int_{\delta \Omega} \frac{\gamma}{h_s} \nu (\mathbf{v} \times \mathbf{n}) \cdot \mathbf{A}_D\\
  \int_{\Omega} \mathbf{A} \cdot \nabla q &amp;= 0
  \end{align}
  </p>
</div>
</div>
<div class="sect3">
<h4 id="_discretization">Discretization</h4>
<div class="paragraph">
<p>Since \mathbf{A} must be in H(\mathrm{curl},\Omega), we need to use Nédélec elements, see <a href="../Appendix/Notations.adoc">Notations</a>. On the strong form, the discrete problem becomes:<br>
Find (\mathbf{A}_h,p_h)\in (H_{\mathbf{A}_D,h}(\mathrm{curl},\Omega)\times P_{c,h}^1(\Omega)) such that

\begin{aligned}
  &amp; \int_{\Omega}\nu_0(\nabla \times \mathbf{A}_h) \cdot (\nabla \times \mathbf{v}_h)
    + \int_{\Omega} \mathbf{v}_h \cdot \nabla p_h = \int_{\Omega} \mathbf{J} \cdot \mathbf{v}_h - \int_{\Omega} (\nabla \times \mathbf{I})\cdot \mathbf{v}_h  ~~\forall \mathbf{v}_h \in H_{0,h}(\mathrm{curl},\Omega) \\
  &amp; \int_{\Omega} \mathbf{A}_h \cdot \nabla q_h = 0 ~~\forall q_h \in P_{0,c,h}^1(\Omega)
\end{aligned}

On the weak form, the discrete problem becomes:<br>
Find (\mathbf{A}_h,p_h)\in (H_{h}(\mathrm{curl},\Omega)\times P_{c,h}^1(\Omega)) such that   \forall (\mathbf{v}_h,q_h) \in H_h(\mathrm{curl},\Omega)\times P^1_{0,c,h}(\Omega)

\begin{align}
  \int_{\Omega}\nu(\nabla \times \mathbf{A}_h) \cdot (\nabla \times \mathbf{v}_h)
  + \int_{\delta \Omega}\nu (\nabla \times \mathbf{A}_h) \cdot (\mathbf{v}_h \times \mathbf{n})&amp;\\
  + \int_{\delta \Omega}\nu (\nabla \times \mathbf{v}_h) \cdot (\mathbf{A}_h \times \mathbf{n})
  + \int_{\delta \Omega} \frac{\gamma}{h_s} \nu (\mathbf{v}_h \times \mathbf{n}) \cdot (\mathbf{A}_h \times \mathbf{n})&amp; \\
  + \int_{\Omega} \mathbf{v}_h \cdot \nabla p_h
  &amp;= \int_{\Omega} \mathbf{J} \cdot \mathbf{v}_h
  - \int_{\Omega} (\nabla \times \mathbf{I})\cdot \mathbf{v}_h\\
  &amp;+ \int_{\delta \Omega}\nu (\nabla \times \mathbf{v}_h) \cdot \mathbf{A}_D
  + \int_{\delta \Omega} \frac{\gamma}{h_s} \nu (\mathbf{v}_h \times \mathbf{n}) \cdot \mathbf{A}_D\\
  \int_{\Omega} \mathbf{A}_h \cdot \nabla q_h &amp;= 0
  \end{align}
  </p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regularized_formulation">Regularized formulation</h3>
<div class="paragraph">
<p>The second way consists of considering the ungauged problem as a special case of the time harmonic Maxwell&#8217;s equations. Then using a Fourier transform, we can write the problem as:

\begin{aligned}
\nabla\times\nu_0\nabla\times\mathbf{A} + \varepsilon\mathbf{A} &amp;= \mathbf{J} - \nabla\times\mathbf{I} &amp;\text{ in } \Omega\\
\mathbf{A}\times\mathbf{n} &amp;= \mathbf{A}_D &amp;\text{ on } \partial\Omega
\end{aligned}
</p>
</div>
<div class="sect3">
<h4 id="_variational_formulation_2">Variational formulation</h4>
<div class="paragraph">
<p>The variational formulation obtained consists in finding \mathbf{A} \in X \subset H(\mathrm{curl},\Omega) such that

\begin{aligned}
  \int_{\Omega}\nu_0(\nabla \times \mathbf{A}) \cdot (\nabla \times \mathbf{v})
  + \int_{\delta \Omega}\nu_0 (\nabla \times \mathbf{A}) \cdot (\mathbf{v} \times \mathbf{n} )
  + \int_{\Omega}\varepsilon \mathbf{A} \cdot \mathbf{v}  = \int_{\Omega} \mathbf{J} \cdot \mathbf{v} - \int_{\Omega} (\nabla \times \mathbf{I}) \cdot \mathbf{v} ~\forall \mathbf{v} \in Y
\end{aligned}

Imposing the Dirichlet boundary condition on strong form, removes the boundary term and the condition is inherent to he function space X = H(\mathbf{A}_D,\mathrm{curl},\Omega). The variational formulation becomes : Find \mathbf{A} \in H_{\mathbf{A}_D}(\mathrm{curl},\Omega) such that

\begin{aligned}
  \int_{\Omega}\nu_0(\nabla \times \mathbf{A}) \cdot (\nabla \times \mathbf{v})
  + \int_{\Omega}\varepsilon \mathbf{A} \cdot \mathbf{v}  = \int_{\Omega} \mathbf{J} \cdot \mathbf{v} - \int_{\Omega} (\nabla \times \mathbf{I}) \cdot \mathbf{v} \quad \forall \mathbf{v} \in H_{0}(\mathrm{curl},\Omega)
\end{aligned}

We can also impose the Dirichlet boundary conditions on weak form, adding symetrization and penalisation terms and then avoiding to add condition in X function space, i.e. X = H(\mathrm{curl},\Omega). As previously, \gamma is the penalisation coefficient and h_s the mesh size. The variational formulation consists then in finding \mathbf{A} \in H(\mathrm{curl},\Omega) such that \forall \mathbf{v} \in H(\mathrm{curl},\Omega)

\begin{align*}
  \int_{\Omega}\nu(\nabla \times \mathbf{A}) \cdot (\nabla \times \mathbf{v})
  + \int_{\delta \Omega}\nu (\nabla \times \mathbf{A}) \cdot (\mathbf{v} \times \mathbf{n} )&amp;\\
  + \int_{\delta \Omega}\nu (\nabla \times \mathbf{v}) \cdot (\mathbf{A} \times \mathbf{n} )
  + \int_{\delta \Omega} \frac{\gamma}{h_s} \nu  (\mathbf{v} \times \mathbf{n} ) \cdot (\mathbf{A} \times \mathbf{n} )&amp;\\
  + \int_{\Omega}\alpha \mathbf{A} \cdot \mathbf{v}
  &amp;= \int_{\Omega} \mathbf{J} \cdot \mathbf{v}
  - \int_{\Omega} (\nabla \times \mathbf{I}) \cdot \mathbf{v} \\
  &amp;+ \int_{\delta \Omega}\nu (\nabla \times \mathbf{v}) \cdot \mathbf{A}_D
  + \int_{\delta \Omega} \frac{\gamma}{h_s} \nu  (\mathbf{v} \times \mathbf{n} ) \cdot \mathbf{A}_D
\end{align*}
</p>
</div>
</div>
<div class="sect3">
<h4 id="_discretization_2">Discretization</h4>
<div class="paragraph">
<p>On strong form, the discrete problem is: find \mathbf{A}_h\in H_{\mathbf{A}_D,h}(\mathrm{curl},\Omega) such that

\begin{aligned}
  \int_{\Omega}\nu_0(\nabla \times \mathbf{A}_h) \cdot (\nabla \times \mathbf{v}_h)
  + \int_{\Omega}\varepsilon \mathbf{A}_h \cdot \mathbf{v}_h  = \int_{\Omega} \mathbf{J} \cdot \mathbf{v}_h - \int_{\Omega} (\nabla \times \mathbf{I}) \cdot \mathbf{v}_h \quad \forall \mathbf{v}_h \in H_{0,h}(\mathrm{curl},\Omega)
\end{aligned}

On weak form, the discrete problem is : find \mathbf{A}_h\in H(\mathrm{curl},\Omega) such that \forall \mathbf{v}_h \in H(\mathrm{curl},\Omega)

\begin{align}
  \int_{\Omega}\nu(\nabla \times \mathbf{A}_h) \cdot (\nabla \times \mathbf{v}_h)
  + \int_{\delta \Omega}\nu (\nabla \times \mathbf{A}_h) \cdot (\mathbf{v}_h \times \mathbf{n} )&amp;\\
  + \int_{\delta \Omega}\nu (\nabla \times \mathbf{v}_h) \cdot (\mathbf{A}_h \times \mathbf{n} )
  + \int_{\delta \Omega} \frac{\gamma}{h_s} \nu  (\mathbf{v}_h \times \mathbf{n} ) \cdot (\mathbf{A}_h \times \mathbf{n} )&amp; \\
  + \int_{\Omega}\alpha \mathbf{A}_h \cdot \mathbf{v}_h
  &amp;= \int_{\Omega} \mathbf{J} \cdot \mathbf{v}_h
  - \int_{\Omega} (\nabla \times \mathbf{I}) \cdot \mathbf{v}_h \\
  &amp;+ \int_{\delta \Omega}\nu (\nabla \times \mathbf{v}_h) \cdot \mathbf{A}_D
  + \int_{\delta \Omega} \frac{\gamma}{h_s} \nu  (\mathbf{v}_h \times \mathbf{n} ) \cdot \mathbf{A}_D
\end{align}
</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_solver_and_preconditionner">Solver and Preconditionner</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are many methods available to solve the saddle-point formulation, using iterative solvers.
Considering the number of non zero entries in the matrix to inverse due to the use of edge based finite elements, this method proves to be inefficient for this problem.</p>
</div>
<div class="paragraph">
<p>A block diagonal preconditioning approach for the time-harmonic Maxwell equations is introduced in <a href="../Appendix/Bibliography/readme.adoc#Greif07">Greif-Schötzau</a>.
Combined with a nodal auxiliary space preconditioning technique proposed in <a href="../Appendix/Bibliography/readme.adoc#Xu07">Hiptmair-Xu</a> specifically designed for H(\mathrm{curl})-conforming finite element, this method gives attractive performance results detailed in <a href="../Appendix/Bibliography/readme.adoc#Li2010">Li</a>.</p>
</div>
<div class="paragraph">
<p>This section describes the main ingredients of preconditioning method introduced in <a href="../Appendix/Bibliography/readme.adoc#Li2010">Li</a>.
Based on the saddle point formulation, the magnetostatic problem reads on the form \mathcal{K} \mathbf{x} = \mathbf{b}

\underbrace{
    \begin{pmatrix}
      \mathcal{A} &amp; \mathcal{B}^{T} \\
      \mathcal{B} &amp; 0
    \end{pmatrix}
  }_{\mathcal{K}}
  \underbrace{
    \begin{pmatrix}
      \mathbf{A} \\
      p
    \end{pmatrix}
  }_{x}
  =
  \underbrace{
  \begin{pmatrix}
      \mathbf{f} \\
      0
    \end{pmatrix}
  }_{b}
</p>
</div>
<div class="paragraph">
<p>The solving of this system is performed at two solver "levels". An outer solver dealing with the resolution of the previous system with the block diagonal preconditioner <a href="../Appendix/Bibliography/readme.adoc#Greif07">Greif-Schötzau</a>, and an inner solver dealing with the application of auxiliary space preconditioning technique <a href="../Appendix/Bibliography/readme.adoc#Xu07">Hiptmair-Xu</a> to the first block of the latter.</p>
</div>
<div class="sect2">
<h3 id="_outer_solver">Outer solver</h3>
<div class="paragraph">
<p>The block diagonal preconditioner proposed in <a href="../Appendix/Bibliography/readme.adoc#Greif07">Greif-Schötzau</a> consists in

  \mathcal{P}_{\mathcal{M},\mathcal{L}} =
  \begin{pmatrix}
      \mathcal{P}_{\mathcal{M}} &amp; 0 \\
      0 &amp; \mathcal{L}
    \end{pmatrix}

where

  \mathcal{P}_{\mathcal{M}} = \mathcal{A} + \mathcal{M} ~\text{with} ~\mathcal{M}_{i,j} = \displaystyle{ \int_{\Omega} \psi_j \cdot \psi_i },  ~~1 \leqslant i,j \leqslant n

and \mathcal{L} the scalar Laplacian on Q_h defined as

  \mathcal{L} = \displaystyle{ \int_{\Omega} \nabla \phi_j \cdot \nabla \phi_i }, ~~1 \leqslant i,j \leqslant m
</p>
</div>
<div class="paragraph">
<p>The outer solver for \mathcal{K}\mathbf{x}=\mathbf{b} is a preconditioned MINRES, using previously defined \mathcal{P}_{\mathcal{M},\mathcal{L}} as preconditioner.
The linear system to solve then reads \mathcal{P}_{\mathcal{M},\mathcal{L}} ~\mathcal{K} \mathbf{x} = \mathcal{P}_{\mathcal{M},\mathcal{L}} ~\mathbf{b}

    \underbrace{
    \begin{pmatrix}
      \mathcal{P}_{\mathcal{M}} &amp; 0 \\
      0 &amp; \mathcal{L}
    \end{pmatrix}
  }_{\mathcal{P}_{\mathcal{M},\mathcal{L}}}
  \underbrace{
    \begin{pmatrix}
      \mathbf{v} \\
      q
    \end{pmatrix}
  }_{x_{out}}
  =
  \underbrace{
    \begin{pmatrix}
      \mathbf{c} \\
      d
    \end{pmatrix}
  }_{b_{out}}
</p>
</div>
<div class="paragraph">
<p>This linear system is solved block by block, using subspace solvers. The block (1,1) consists in the linear system

  \mathcal{P}_{\mathcal{M}} \mathbf{v} = \mathbf{c}

and the block (2,2) is the linear system

  \mathcal{L} q = d
</p>
</div>
<div class="paragraph">
<p>The resolution of both systems gives the solution (\mathbf{v},q) from which we conclude current MINRES iteration updating \mathbf{x} in \mathcal{K}\mathbf{x}=\mathbf{b}.
The same process can then applied for each MINRES iteration, until convergence.</p>
</div>
<div class="paragraph">
<p>While the solving of the scalar elliptic problem \mathcal{L} q = d can be efficiently performed with standard methods, the  H(\mathrm{curl})-conforming linear system \mathcal{P}_{\mathcal{M}} \mathbf{v} = \mathbf{c} of the outer problem is more tricky.
This bottleneck can be overcomed using a second level of preconditioning, applying the effective auxiliary space preconditioning method \cite{HiptmairXu} to the inner problem \mathcal{P}_{\mathcal{M}} \mathbf{v} = \mathbf{c}.</p>
</div>
</div>
<div class="sect2">
<h3 id="_inner_solver">Inner solver</h3>
<div class="paragraph">
<p>The preconditioning method proposed in \cite{HiptmairXu} is used to solve the linear system \mathcal{P}_{\mathcal{M}} \mathbf{v} = \mathbf{c}.</p>
</div>
<div class="paragraph">
<p>This system is solved using a preconditioned conjugate gradient (CG) and then reads \mathcal{P}_{V} \mathcal{P}_{\mathcal{M}} \mathbf{v} = \mathcal{P}_{V} \mathbf{c}, where \mathcal{P}_{V} is the preconditioner to be descibed.
The linear system to solve then becomes

  \mathcal{P}_{V} \mathbf{w} = \mathbf{r}
</p>
</div>
<div class="paragraph">
<p>The preconditioner \mathcal{P}_{V} is defined such that

  \mathcal{P}_{V}^{-1} = diag(\mathcal{P}_{\mathcal{M}})^{-1} + P(\bar{\mathcal{L}} + \bar{\mathcal{Q}})^{-1}P^{T} + C(\bar{\mathcal{L}}^{-1})C^{T}
</p>
</div>
<div class="paragraph">
<p>where

\bar{\mathcal{L}} = \frac{1}{\mu} diag(\mathcal{L},\mathcal{L},\mathcal{L})

and

  \bar{\mathcal{Q}} = diag(\mathcal{M},\mathcal{M},\mathcal{M})
</p>
</div>
<div class="paragraph">
<p>The matrix C is composed by the coefficients of the gradient of Q_h basis functions \phi_j in the H(\mathrm{curl})-conforming space V_h

  C = \{ C_{i,j} \} ~1 \leqslant i \leqslant n, ~1 \leqslant j \leqslant m ~\text{such that} ~ \nabla \phi_j = \sum \limits_{i=1}^{n} C_{i,j} \psi_i ~1 \leqslant j \leqslant m

and the matrix P is the nodal interpolation operator \Pi_{h}^{\mathrm{curl}} from Q_h^3 to V_h.</p>
</div>
<div class="paragraph">
<p>From the definition of \mathcal{P}_V, the linear system \mathcal{P}_{V} \mathbf{w} = \mathbf{r} gives

  \mathbf{w} = diag(\mathcal{P}_{\mathcal{M}})^{-1} \mathbf{r} + P\mathbf{y} + C \mathbf{z}
  ~~\text{with} ~\mathbf{y} = (\bar{\mathcal{L}} + \bar{\mathcal{Q}})^{-1}P^{T}\mathbf{r}
  ~~\text{and} ~\mathbf{z} = \bar{\mathcal{L}}^{-1} C^{T} \mathbf{r}
</p>
</div>
<div class="paragraph">
<p>The terms \mathbf{y} and \mathbf{z} are computed by solving two linear systems

\begin{align}
   &amp; (\bar{\mathcal{L}} + \bar{\mathcal{Q}}) \mathbf{y} = P^{T}\mathbf{r} \\
   &amp; \mathcal{L} \mathbf{z} = C^{T} \mathbf{r}
\end{align}
</p>
</div>
<div class="paragraph">
<p>Then, \mathbf{w} can be updated by solving both systems which solves the linear system \mathcal{P}_{\mathcal{M}} \mathbf{v} = \mathbf{c}.</p>
</div>
</div>
</div>
</div>
<h1 id="_torus_benchmark" class="sect0">Torus Benchmark</h1>
<div class="paragraph">
<p>We need to verify our implementation against physical configuration, we choose to compute the potential vector and the magnetic flux of a torus. This is an axisymmettric configuration and we will work on a quarter of it.</p>
</div>
<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We want to resolve the Maxwell&#8217;s equations presented in <a href="Maxwell.adox">Maxwell</a> and compare them with some exact solutions given by C. Trophime using Bmap.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>TODO</strong> references for solutions and bmap</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The condition \mathbf{A}\times\mathbf{n}=0 on \partial\Omega must be set at the infinity, which is computationally impossible. So we create a sphere around our region of interest to simulate the infinity. This restriction induces an error.<br>
The goal here is to see the influence of the radius of the external sphere on the results.</p>
</div>
<div class="paragraph">
<p>The following figure presents the geometry used. The left part represents a side view, and the right part, an upside view.<br>
<span class="image"><img src="Figures/TorusViews.png" alt=""></span>
<span class="image"><img src="Figures/quartTorus.png" alt="quartTorus" width="500"></span><br>
\Omega=\Omega_c\cup\Omega_n\cup\Omega_f where \Omega_c is the coil, \Omega_n the domain near the coil, where the mesh is thin, \Omega_f where the mesh is coarse. \partial\Omega=\Gamma_s\cup\Gamma_\infty where \Gamma_\infty represents the infinity, we can change R_\infty to study its influence on the results, and \Gamma_s is the boundary due to the symmetry.</p>
</div>
<div class="sect2">
<h3 id="_boundary_conditions_4">Boundary conditions</h3>
<div class="paragraph">
<p>We set</p>
</div>
<div class="ulist">
<ul>
<li>
<p>on \Gamma_\infty, we chose our potential vector to be null:

  \mathbf{A}\times\mathbf{n} = 0
</p>
</li>
<li>
<p>on \Gamma_s, due to the symmetry of the geometry, we have also:

  \mathbf{A}\times\mathbf{n} = 0
</p>
</li>
<li>
<p>and in the saddle-point case, on \partial\Omega,

  p = 0
</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inputs">Inputs</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Parameter set definition</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We impose the electric current on the coil, \Omega_c. We use two different current, an uniform electric current J_1, and a non uniform current J_2.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 18. Fixed and Variable Input Parameters</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Nominal Value</th>
<th class="tableblock halign-left valign-top">Range</th>
<th class="tableblock halign-left valign-top">Units</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">J_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniform electric current</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\frac{12.10^{6}}{\pi\sqrt{x^2+y^2} }\begin{pmatrix} -y\\ x\\ 0 \end{pmatrix}</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\frac{A}{m^2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">J_2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">non uniform electric current</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\frac{12.10e{^6}}{\pi\left(x^2+y^2\right)}\begin{pmatrix} -y\\ x\\ 0 \end{pmatrix}</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\frac{A}{m^2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">external radius</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[0.2:0.2:0.8]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>Solver and preconditioner used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The solver and preconditionner are the ones detail in <a href="../Strategy.adoc">Resolution Strategy</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_outputs">Outputs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Two metrics are of interests, the relative error on the potential

  \frac{||\mathbf{A}-\mathbf{A}_{ex}||_{L_2}}{||\mathbf{A}_{ex}||_{L_2}}

and the relative error on the magnetic flux

  \frac{||\mathbf{B}-\mathbf{B}_{ex}||_{L_2}}{||\mathbf{B}_{ex}||_{L_2}}
</p>
</div>
<div class="paragraph">
<p>These errors can be computed either in the whole domain, \Omega, either in a ball inside of the region of interest, B(R_{int}), that is, inside the torus (in our case R_{int}=0.0306)<br>
In a physical point of view, the later is more natural because this is where we need to know what happens.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_discretization_3">Discretization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We use differents size for the external sphere&#8217;s <strong>Radius</strong>, 0.2,0.4,0.6,0.8, and different characteristic <strong>size</strong> for the mesh. Which give the following problems' sizes, in terms of degrees of freedom for <strong>Nedelec</strong> elements, <strong>Lagrange</strong> elements and number of <strong>Elements</strong>.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 75%;">
<caption class="title">Table 19. Size of the problems</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Radius</th>
<th class="tableblock halign-center valign-top">Size</th>
<th class="tableblock halign-center valign-top">Nedelec</th>
<th class="tableblock halign-center valign-top">Lagrange</th>
<th class="tableblock halign-center valign-top">Elements</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.002</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">30 274</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4 829</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">26 819</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.001</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">175 918</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">26 830</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">153 811</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.0005</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1 295 463</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">190 138</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1 123 817</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.4</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.002</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">30 335</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4 850</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">27 046</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.4</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.001</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">185 351</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">28 157</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">162 558</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.4</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.0005</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1 340 051</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">197 203</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1 163 839</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.6</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.002</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">31 409</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">5 126</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">28 026</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.6</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.001</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">196 658</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">30 044</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">172 901</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.6</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.0005</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1 436 732</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">212 077</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1 249 418</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.8</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.002</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">35 006</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">5 692</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">31 428</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.8</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.001</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">215 315</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">33 094</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">189 770</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.8</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0.0005</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1 558 174</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">230 775</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1 356 968</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_implementation">Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The implementation can be found in  <a href="https://github.com/feelpp/solodem/blob/9f33195bb24d418fb3cee6e959784803c9c2898e/src/TorusQuart">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_results">Results</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_potential_vector">Potential vector</h3>
<div class="paragraph">
<p>The regularized formulation does not make sense for the potential, since it is known up to a gradient.<br>
The following figures present the errors depending on the current and the domain in which the error is computed. Each figure shows the error depending on the mesh size for the differents external radius R_\infty. The two first figures exhibit the behavior of the saddle point formulation, whereas the last two, exhibit the regularized formulation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="Figures/TorusGraph/ANuniSaddO.png" alt="ANuniSaddO" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/ANuniSaddR.png" alt="ANuniSaddR" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/AUniSaddO.png" alt="AUniSaddO" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/AUniSaddR.png" alt="AUniSaddR" width="300"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_magnetic_flux">Magnetic flux</h3>
<div class="paragraph">
<p>The following table presents the errors for the non-uniform current depending on the formulation and the domain in which the error is computed. Each figure shows the error depending on the mesh size for the differents external radius R_\infty. The two first figures exhibit the behavior of the saddle point formulation, whereas the last two, exhibit the regularized formulation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="Figures/TorusGraph/BNuniSaddO.png" alt="BNuniSaddO" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/BNuniSaddR.png" alt="BNuniSaddR" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/BNuniStabO.png" alt="BNuniStabO" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/BNuniStabR.png" alt="BNuniStabR" width="300"></span></p>
</div>
<div class="paragraph">
<p>The following table presents the errors for the uniform current depending on the formulation and the domain in which the error is computed. Each figure shows the error depending on the mesh size for the differents external radius R_\infty. The two first figures exhibit the behavior of the saddle point formulation, whereas the last two, exhibit the regularized formulation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="Figures/TorusGraph/BUniSaddO.png" alt="BUniSaddO" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/BUniSaddR.png" alt="BUniSaddR" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/BUniStabO.png" alt="BUniStabO" width="300"></span>
<span class="image"><img src="Figures/TorusGraph/BUniStabR.png" alt="BUniStabR" width="300"></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We can extract here some results:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the formulation or the type of current has no influence on the results,</p>
</li>
<li>
<p>the difference between the errors computed in \Omega and in B(R_{int}), a factor 4 for \mathbf{B} and 10 for \mathbf{A}, shows that the errors occure in particular in \Omega_f. This is due to the approximation on the boundary condition on \Gamma_\infty,</p>
</li>
<li>
<p>the distance R_\infty allows to have better approximations as it grows, until it reachs a certain bound, between 0.4 and 0.6 depending on the characteristic size of the mesh</p>
</li>
</ul>
</div>
</div>
</div>
<h1 id="_inductor_benchmark" class="sect0">Inductor Benchmark</h1>
<div class="paragraph">
<p>We now want to compare our implementation with another one, written with the  <a href="http://getdp.info/">GetDP</a> solver, by P. Dular and C. Geuzaine.
For this, we will use the example of the <a href="http://onelab.info/wiki/Inductor">Inductor</a>.</p>
</div>
<div class="sect1">
<h2 id="_description_2">Description</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_geometry">Geometry</h3>
<div class="paragraph">
<p>The experience consist on an inductor that generates a magnetic field.
This inductor is surrounded by two cores, themselves seperated by a thin space of air.
The two cores and the inductor are intermingle like this:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="Figures/CoilCore.png" alt="Coil and Cores" width="400">
</div>
<div class="title">Figure 1. A mesh of the domain</div>
</div>
<div class="paragraph">
<p>As in the <a href="../Torus/readme.adoc">torus</a> benchmark, we encompass this set by a sphere representing the air until the infinity.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Front View
<span class="image"><img src="Figures/InductorXY.png" alt="View XY" width="400" title="Front view"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Top View
<span class="image"><img src="Figures/InductorXZ.png" alt="View XZ" width="400" title="Top view"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>\Omega=\Omega_{core}\cup\Omega_{coil}\cup\Omega_n\cup\Omega_\infty where \Omega_n corresponds to the thin mesh near the coil, \Omega_\infty the coarse mesh far away and  \Gamma_\infty the approximation of the infinity.</p>
</div>
</div>
<div class="sect2">
<h3 id="_magnetic_permeability">Magnetic permeability</h3>
<div class="paragraph">
<p>Two kinds of experiments are done here: linear and non linear.</p>
</div>
<div class="sect3">
<h4 id="_linear">Linear</h4>
<div class="paragraph">
<p>For the linear case, the relative magnetic permeability is piecewise constant.
We have chosen to set it to 2 000 in the cores, and 1 everywhere else.</p>
</div>
</div>
<div class="sect3">
<h4 id="_non_linear">Non linear</h4>
<div class="paragraph">
<p>For the non linear case, the relative magnetic permeability is set to 1 everywhere exept on the cores.
We uses there the following law that is given with a set of points.
We use extrapolation to extend the magnetic permeability when \mathbf{H} goes to infinity.
The interpolation is done with the Akima&#8217;s one.</p>
</div>
<div id="bh_curve" class="imageblock" style="text-align: center">
<div class="content">
<img src="Figures/BH.png" alt="BH" width="300">
</div>
<div class="title">Figure 2. B-H curve given in the source code of the benchmark</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_boundary_conditions_5">Boundary conditions</h3>
<div class="paragraph">
<p>We set</p>
</div>
<div class="ulist">
<ul>
<li>
<p>on \Gamma_\infty, we chose our potential vector to be null:

  \mathbf{A}\times\mathbf{n} = 0
</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inputs_2">Inputs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The source term - \mathbf{J} - is given with an analytical expression scalled with the coil properties to mimic a constant field in the inductor.</p>
</div>
<div class="paragraph">
<p>We decompose \Omega_{Coil} in a partition of eight parts defined :</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 20. Decomposition of \Omega_{Coil}</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\Omega_{1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x &lt; w_{E}~AND~x &gt; -w_{E}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z &gt; \frac{Lz}{2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\Omega_{2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x &lt; w_{E}~AND~x &gt; -w_{E}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z &lt; \frac{Lz}{2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\Omega_{3}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x&gt;w_{E}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z &lt; \frac{Lz}{2}~AND~x &gt; -\frac{Lz}{2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\Omega_{4}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x&lt;-w_{E}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z &lt; \frac{Lz}{2}~AND~x &gt; -\frac{Lz}{2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\Omega_{5}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x&gt;w_{E}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z&gt;\frac{Lz}{2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\Omega_{6}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x&gt;w_{E}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z&lt;-\frac{Lz}{2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\Omega_{7}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x&lt;-w_{E}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z&gt;\frac{Lz}{2}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\Omega_{8}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x&lt;-w_{E}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">z&lt;-\frac{Lz}{2}</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Thus, the right hand side reads:</p>
</div>
<div class="paragraph">
<p>$$
\begin{align}
\mathbf{J}&amp;=\frac{-nW}{s}
\left(
\left.
\begin{pmatrix}
1 \\ 0 \\ 0
\end{pmatrix}\right|_{\Omega_1}</p>
</div>
<div class="paragraph">
<p>+
\left.
\begin{pmatrix}
-1 \\ 0 \\ 0
\end{pmatrix}\right|_{\Omega_2}</p>
</div>
<div class="paragraph">
<p>+
\left.
\begin{pmatrix}
0 \\ 0 \\ -1
\end{pmatrix}\right|_{\Omega_3}</p>
</div>
<div class="paragraph">
<p>+
\left.
\begin{pmatrix}
0 \\ 0 \\ 1
\end{pmatrix}\right|_{\Omega_4}
\right.\\&amp;\left.
\left.
\begin{pmatrix}
\sin\left(\rm atan2\left(z-\frac{Lz}{2},x-w_{E}\right)\right) \\ 0 \\ -\cos\left(\rm atan2\left(z-\frac{Lz}{2},x-w_{E}\right)\right)
\end{pmatrix}\right|_{\Omega_5}
\right.\\&amp;\left.</p>
</div>
<div class="paragraph">
<p>+
\left.
\begin{pmatrix}
\sin\left(\rm atan2\left(z+\frac{Lz}{2},x-w_{E}\right)\right) \\ 0 \\ -\cos\left(\rm atan2\left(z+\frac{Lz}{2},x-w_{E}\right)\right)
\end{pmatrix}\right|_{\Omega_6}
\right.\\&amp;+\left.</p>
</div>
<div class="paragraph">
<p>+
\left.
\begin{pmatrix}
\sin\left(\rm atan2\left(z-\frac{Lz}{2},x+w_{E}\right)\right) \\ 0 \\ -\cos\left(\rm atan2\left(z-\frac{Lz}{2},x+w_{E}\right)\right)
\end{pmatrix}\right|_{\Omega_7}
\right.\\&amp;+\left.</p>
</div>
<div class="paragraph">
<p>+
\left.
\begin{pmatrix}
\sin\left(\rm atan2\left(z+\frac{Lz}{2},x-w_{E}\right)\right) \\ 0 \\ -\cos\left(\rm atan2\left(z+\frac{Lz}{2},x-w_{E}\right)\right)
\end{pmatrix}\right|<em>{\Omega_8}
\right)
\end{align}

where w</em>{E} is the height of the coil, Lz the, Nw the number of turns and s$$ the section of the coil.</p>
</div>
<div class="paragraph">
<p>We have run the benchmark with the following parameters:</p>
</div>
<table class="tableblock frame-topbot grid-all" style="width: 50%;">
<caption class="title">Table 21. Parameters</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>\mu_r(\Omega_{Core})</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>2000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>\mu_r(\Omega \backslash \Omega_{core} )</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>Current</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>Number of turns</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>288</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The geometry embed the air gap in the Core and we do not use the shell transformation to infinity.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_outputs_2">Outputs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have chose to compare the flux and the magnetic energy.
The flux is defined as:

F = \frac{1}{2}\int_{\Omega_{coil}}\mathbf{J} \cdot \mathbf{A}

The magnetic energy is defined as:

M = \frac{1}{2}\int_{\Omega} \mathbf{B} \cdot \mathbf{H}
</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_discretization_4">Discretization</h2>
<div class="sectionbody">
<table class="tableblock frame-topbot grid-all spread">
<caption class="title">Table 22. Mesh characteristics</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">Mesh id</th>
<th class="tableblock halign-center valign-top">Number of elements</th>
<th class="tableblock halign-center valign-top">Linear system size (Feel++)</th>
<th class="tableblock halign-center valign-top">Size A</th>
<th class="tableblock halign-center valign-top">size p</th>
<th class="tableblock halign-center valign-top">Size GetDP</th>
<th class="tableblock halign-center valign-top">Linear system size ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>Mesh 1</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>21 739</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>25 720</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>22 517</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>3 203</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>19 249</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>1.33</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>Mesh 2</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>89 749</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>119 348</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>104 663</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>14 685</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>89 521</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>1.3</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>Mesh 3</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>572 207</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>706 192</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>620544</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>85 648</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>533 161</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>1.27</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The difference between size of \mathbf{A} and getDp can come from the duplicates elements in the mesh that Feel++ does not ignore at run time.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_results_2">Results</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_linear_simulations">Linear simulations</h3>
<table class="tableblock frame-topbot grid-all spread">
<caption class="title">Table 23. Magnetic energy</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top"></th>
<th class="tableblock halign-center valign-top">Mesh 1</th>
<th class="tableblock halign-center valign-top">Mesh 2</th>
<th class="tableblock halign-center valign-top">mesh 3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>GetDP</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.0638797</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.0661257</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.0672932</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>Feel++</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.07189111</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.07075924</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.06945127</em></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-topbot grid-all spread">
<caption class="title">Table 24. Flux</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">x</th>
<th class="tableblock halign-center valign-top">Mesh 1</th>
<th class="tableblock halign-center valign-top">Mesh 2</th>
<th class="tableblock halign-center valign-top">mesh 3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>GetDP</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.127856</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.132496</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.134572</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>Feel++</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.1129086</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.1238156</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>0.1297857</em></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-topbot grid-all spread">
<caption class="title">Table 25. Time to solve</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">x</th>
<th class="tableblock halign-center valign-top">Mesh 1</th>
<th class="tableblock halign-center valign-top">Mesh 2</th>
<th class="tableblock halign-center valign-top">mesh 3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>GetDP</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>2.78</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>38.02</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>1 271.11</em></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock"><strong>Feel++</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>4.82</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>27.37</em></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><em>202</em></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As long as GetDP solve the system with LU (mumps), the time to solve results are not at all surprising.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 26. Comparison of B components along x axis</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_bx_2.png" alt="x bx 2"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_by_2.png" alt="x by 2"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_bz_2.png" alt="x bz 2"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_bx_1.png" alt="x bx 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_by_1.png" alt="x by 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_bz_1.png" alt="x bz 1"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_bx_05.png" alt="x bx 05"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_by_05.png" alt="x by 05"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/x_bz_05.png" alt="x bz 05"></span></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 27. Comparison of B components along y axis</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_bx_2.png" alt="y bx 2"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_by_2.png" alt="y by 2"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_bz_2.png" alt="y bz 2"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mesh 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_bx_1.png" alt="y bx 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_by_1.png" alt="y by 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_bz_1.png" alt="y bz 1"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_bx_05.png" alt="y bx 05"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_by_05.png" alt="y by 05"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/y_bz_05.png" alt="y bz 05"></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_non_linear_simulations">Non linear simulations</h3>
<div class="paragraph">
<p>Here we set the current to 1 and the number of turns to 2880.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 28. Magnetic Energy</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.15153</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.36391</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.72932</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feel++ (Picard)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.869402</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.791739</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feel++ (Polarization)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.527268</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.501092</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 29. Flux</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetDP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.3122</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.7512</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13.4572</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feel++ (Picard)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.86511</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11.90325</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feel++ (Polarization)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.40574</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11.41853</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>We do not monitor the time to solve.
Actually, the non linear method and the backend configuration has nothing in common.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 30. Comparison of B components along x axis</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_x_bx_2.png" alt="nl x bx 2"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_x_by_2.png" alt="nl x by 2"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_x_bz_2.png" alt="nl x bz 2"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_x_bx_1.png" alt="nl x bx 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_x_by_1.png" alt="nl x by 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_x_bz_1.png" alt="nl x bz 1"></span></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 31. Comparison of B components along y axis</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_y_bx_2.png" alt="nl y bx 2"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_y_by_2.png" alt="nl y by 2"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_y_bz_2.png" alt="nl y bz 2"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mesh 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_y_bx_1.png" alt="nl y bx 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_y_by_1.png" alt="nl y by 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="Figures/nl_y_bz_1.png" alt="nl y bz 1"></span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion_2">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We successfully reproduce the Inductor benchmark.
With no surpise - as long as the GetDP resolution is LU in sequential - we are able to handle very small meshes.
We should implement the Newton method for the treatment of the non linearity.
Numerical experiments shown Picard is much closer to the results given by GetDP that the Polarization method</p>
</div>
</div>
</div>
<h1 id="_team_workshop_13_benchmark" class="sect0">Team Workshop 13 Benchmark</h1>
<div class="paragraph">
<p>The TEAM Workshop 13 <a href="http://www.emeraldinsight.com/doi/pdfplus/10.1108/eb010097">benchmark</a>  aims to compare various formulations and implementations to solve the non linear magnetostatic problem. We reproduce that benchmark to evaluate the accuracy of our implementation.</p>
</div>
<div class="sect1">
<h2 id="_description_3">Description</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_geometry_2">Geometry</h3>
<div class="paragraph">
<p>The geometry consists on an exiting coil set between two steel channels which are not aligned together and a steel plate inserted inside the channels.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="Figures/tws13_model.png" alt="TWS Geometry"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_magnetic_permeability_2">Magnetic permeability</h3>
<div class="paragraph">
<p>We only process non linear problems.</p>
</div>
<div class="paragraph">
<p>To discriminate if the non linear law has an impact on the convergence, we run that benchmark with three B-H curves.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the one given by the Team Workshop 13 Benchmark,</p>
</li>
<li>
<p>the one given in <a href="../Torus/readme.adoc">GetDP</a>,</p>
</li>
<li>
<p>a third one that is close to the two others, but with intermediate difficulty. We call it <strong>intermediate</strong>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_interpolation">Interpolation</h4>
<div class="paragraph">
<p>As long as we only process isotropic concretes, the non linear relations \mathbf{B} = \mathcal{B}(\mathbf{H}) reads B = \mu(H) H .
It is that curve we have to interpolate.
We propose piecewise linear interpolation and akima&#8217;s interpolation thanks to <a href="http://www.gnu.org/software/gsl/">GSL</a>.</p>
</div>
<div class="paragraph">
<p>The provided data are the relation of the magnetic induction amplitude B against the magnetic field magnitude H.</p>
</div>
<div class="paragraph">
<p>We also tried the interpolation of \mu(H) H and \mu(H) directly. (idem for \nu).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="Figures/NL_law.png" alt="Non Linear relation"></span></p>
</div>
<div class="paragraph">
<p>We can observe the relation given in GetDP is the smoothest one.
For the \Sigma-\Phi case, we only have one twist in the whole curve and the Team Workshop one provide two twists.</p>
</div>
<div class="paragraph">
<p>We use extrapolation to extend the magnetic permeability when \mathbf{H} goes to infinity.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inputs_3">Inputs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The source term - \mathbf{J} - is generated solving a Laplacian in each half coils.
We present here a top view of an half of the coil.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="Figures/half_coil.png" alt="half coil"></span></p>
</div>
<div class="paragraph">
<p>The gradient of the solution of each problems is multiplied with the number of Ampère Turns we want.</p>
</div>
<div class="paragraph">
<p>
\begin{aligned}
    -\Delta u &amp;= 0\\
    \left.  u\right|_{\Gamma+} &amp;= 1\\
    \left.  u\right|_{\Gamma-} &amp;= 0\\
    \mathbf{J} &amp;= At \frac{\nabla u}{\|\nabla u \|}
\end{aligned}
</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_outputs_3">Outputs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will compare the various fluxes the Team Workshop 13 Benchmark present and check the convergence in respect with various parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the formulation: saddle or stabilized,</p>
</li>
<li>
<p>the current density</p>
</li>
<li>
<p>the non linear formulation</p>
</li>
<li>
<p>the \mu discretization (P_1, P_2),</p>
</li>
<li>
<p>the non linear relation.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_behavior">Behavior</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here are the meshes and spaces specifications</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of elements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Dof \mathbb{A}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Dof p</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mesh 1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">634 850</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">741 168</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">106 772</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">847 940</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mesh 2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 070 302</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 748 125</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">679 348</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 427 473</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Every simulation has run over 48 processors on <strong>irma-atlas</strong>.</p>
</div>
<div class="sect2">
<h3 id="_getdp_non_linear_curve">GetDP non linear curve</h3>
<div class="paragraph">
<p>We begin with the smoothiest B-H relation.
At very low current density, both formulations (saddle, regularized), both algorithms (Picard, Polarization) with the two kinds of \mu discretizaion converge.</p>
</div>
<div class="paragraph">
<p>Here we show that the polarization method is not robust against high density current.</p>
</div>
<div class="sect3">
<h4 id="_mesh_1">Mesh 1</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-500-algo-0-mod-inductor3d-feel.png" alt="mesh 1 AT 500 algo 0 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-500-algo-0-mod-inductor3d-feel_time.png" alt="mesh 1 AT 500 algo 0 mod inductor3d feel time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-500-algo-1-mod-inductor3d-feel.png" alt="mesh 1 AT 500 algo 1 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-500-algo-1-mod-inductor3d-feel_time.png" alt="mesh 1 AT 500 algo 1 mod inductor3d feel time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-0-mod-inductor3d-feel.png" alt="mesh 1 AT 1000 algo 0 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-0-mod-inductor3d-feel_time.png" alt="mesh 1 AT 1000 algo 0 mod inductor3d feel time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-1-mod-inductor3d-feel.png" alt="mesh 1 AT 1000 algo 1 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-1-mod-inductor3d-feel_time.png" alt="mesh 1 AT 1000 algo 1 mod inductor3d feel time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-0-mod-inductor3d-feel.png" alt="mesh 1 AT 2000 algo 0 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-0-mod-inductor3d-feel_time.png" alt="mesh 1 AT 2000 algo 0 mod inductor3d feel time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-1-mod-inductor3d-feel.png" alt="mesh 1 AT 2000 algo 1 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-1-mod-inductor3d-feel_time.png" alt="mesh 1 AT 2000 algo 1 mod inductor3d feel time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-0-mod-inductor3d-feel.png" alt="mesh 1 AT 3000 algo 0 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-0-mod-inductor3d-feel_time.png" alt="mesh 1 AT 3000 algo 0 mod inductor3d feel time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-1-mod-inductor3d-feel.png" alt="mesh 1 AT 3000 algo 1 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-1-mod-inductor3d-feel_time.png" alt="mesh 1 AT 3000 algo 1 mod inductor3d feel time"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>At first, we can observe
- the Polarization method does not handle the hight current density,
- the regularized formulation is always faster,
- the saddle point formulation is always more accurate,
- the \mu space discretization has a little impact in the convergence.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mesh_2">Mesh 2</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-500-algo-0-mod-inductor3d-feel.png" alt="mesh 2 AT 500 algo 0 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-500-algo-0-mod-inductor3d-feel_time.png" alt="mesh 2 AT 500 algo 0 mod inductor3d feel time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-500-algo-1-mod-inductor3d-feel.png" alt="mesh 2 AT 500 algo 1 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-500-algo-1-mod-inductor3d-feel_time.png" alt="mesh 2 AT 500 algo 1 mod inductor3d feel time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-0-mod-inductor3d-feel.png" alt="mesh 2 AT 1000 algo 0 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-0-mod-inductor3d-feel_time.png" alt="mesh 2 AT 1000 algo 0 mod inductor3d feel time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-1-mod-inductor3d-feel.png" alt="mesh 2 AT 1000 algo 1 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-1-mod-inductor3d-feel_time.png" alt="mesh 2 AT 1000 algo 1 mod inductor3d feel time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-0-mod-inductor3d-feel.png" alt="mesh 2 AT 2000 algo 0 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-0-mod-inductor3d-feel_time.png" alt="mesh 2 AT 2000 algo 0 mod inductor3d feel time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-1-mod-inductor3d-feel.png" alt="mesh 2 AT 2000 algo 1 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-1-mod-inductor3d-feel_time.png" alt="mesh 2 AT 2000 algo 1 mod inductor3d feel time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-0-mod-inductor3d-feel.png" alt="mesh 2 AT 3000 algo 0 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-0-mod-inductor3d-feel_time.png" alt="mesh 2 AT 3000 algo 0 mod inductor3d feel time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-1-mod-inductor3d-feel.png" alt="mesh 2 AT 3000 algo 1 mod inductor3d feel"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-1-mod-inductor3d-feel_time.png" alt="mesh 2 AT 3000 algo 1 mod inductor3d feel time"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Increasing the dof density does not improve here the convergence of failling method.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_intermediate_non_linear_curve">Intermediate non linear curve</h3>
<div class="sect3">
<h4 id="_mesh_1_2">Mesh 1</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-500-algo-0-mod-sigma-phi.png" alt="mesh 1 AT 500 algo 0 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-500-algo-0-mod-sigma-phi_time.png" alt="mesh 1 AT 500 algo 0 mod sigma phi time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-500-algo-1-mod-sigma-phi.png" alt="mesh 1 AT 500 algo 1 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-500-algo-1-mod-sigma-phi_time.png" alt="mesh 1 AT 500 algo 1 mod sigma phi time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-0-mod-sigma-phi.png" alt="mesh 1 AT 1000 algo 0 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-0-mod-sigma-phi_time.png" alt="mesh 1 AT 1000 algo 0 mod sigma phi time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-1-mod-sigma-phi.png" alt="mesh 1 AT 1000 algo 1 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-1-mod-sigma-phi_time.png" alt="mesh 1 AT 1000 algo 1 mod sigma phi time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-0-mod-sigma-phi.png" alt="mesh 1 AT 2000 algo 0 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-0-mod-sigma-phi_time.png" alt="mesh 1 AT 2000 algo 0 mod sigma phi time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-1-mod-sigma-phi.png" alt="mesh 1 AT 2000 algo 1 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-1-mod-sigma-phi_time.png" alt="mesh 1 AT 2000 algo 1 mod sigma phi time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-0-mod-sigma-phi.png" alt="mesh 1 AT 3000 algo 0 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-0-mod-sigma-phi_time.png" alt="mesh 1 AT 3000 algo 0 mod sigma phi time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-1-mod-sigma-phi.png" alt="mesh 1 AT 3000 algo 1 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-1-mod-sigma-phi_time.png" alt="mesh 1 AT 3000 algo 1 mod sigma phi time"></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_mesh_2_2">Mesh 2</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-500-algo-0-mod-sigma-phi.png" alt="mesh 2 AT 500 algo 0 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-500-algo-0-mod-sigma-phi_time.png" alt="mesh 2 AT 500 algo 0 mod sigma phi time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-500-algo-1-mod-sigma-phi.png" alt="mesh 2 AT 500 algo 1 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-500-algo-1-mod-sigma-phi_time.png" alt="mesh 2 AT 500 algo 1 mod sigma phi time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-0-mod-sigma-phi.png" alt="mesh 2 AT 1000 algo 0 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-0-mod-sigma-phi_time.png" alt="mesh 2 AT 1000 algo 0 mod sigma phi time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-1-mod-sigma-phi.png" alt="mesh 2 AT 1000 algo 1 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-1-mod-sigma-phi_time.png" alt="mesh 2 AT 1000 algo 1 mod sigma phi time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-0-mod-sigma-phi.png" alt="mesh 2 AT 2000 algo 0 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-0-mod-sigma-phi_time.png" alt="mesh 2 AT 2000 algo 0 mod sigma phi time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-1-mod-sigma-phi.png" alt="mesh 2 AT 2000 algo 1 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-1-mod-sigma-phi_time.png" alt="mesh 2 AT 2000 algo 1 mod sigma phi time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-0-mod-sigma-phi.png" alt="mesh 2 AT 3000 algo 0 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-0-mod-sigma-phi_time.png" alt="mesh 2 AT 3000 algo 0 mod sigma phi time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-1-mod-sigma-phi.png" alt="mesh 2 AT 3000 algo 1 mod sigma phi"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-1-mod-sigma-phi_time.png" alt="mesh 2 AT 3000 algo 1 mod sigma phi time"></span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_team_workshop_13_non_linear_curve">TEAM Workshop 13 non linear curve</h3>
<div class="paragraph">
<p>We have observed with the getDP relation the polarization method is not robust.
We have observed with the \Sigma-\Phi relation the regularity of the relation can be a bottleneck.</p>
</div>
<div class="paragraph">
<p>Here, we show the team Workshop 13 B-H relation provide us - at best - non fully convergent simulations and only saddle-point formulation with picard algorithm can be run.</p>
</div>
<div class="sect3">
<h4 id="_mesh_1_3">Mesh 1</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-500-algo-0-mod-tws.png" alt="mesh 1 AT 500 algo 0 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-500-algo-0-mod-tws_time.png" alt="mesh 1 AT 500 algo 0 mod tws time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-500-algo-1-mod-tws.png" alt="mesh 1 AT 500 algo 1 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-500-algo-1-mod-tws_time.png" alt="mesh 1 AT 500 algo 1 mod tws time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-0-mod-tws.png" alt="mesh 1 AT 1000 algo 0 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-0-mod-tws_time.png" alt="mesh 1 AT 1000 algo 0 mod tws time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-1-mod-tws.png" alt="mesh 1 AT 1000 algo 1 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-1000-algo-1-mod-tws_time.png" alt="mesh 1 AT 1000 algo 1 mod tws time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-0-mod-tws.png" alt="mesh 1 AT 2000 algo 0 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-0-mod-tws_time.png" alt="mesh 1 AT 2000 algo 0 mod tws time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-1-mod-tws.png" alt="mesh 1 AT 2000 algo 1 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-2000-algo-1-mod-tws_time.png" alt="mesh 1 AT 2000 algo 1 mod tws time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-0-mod-tws.png" alt="mesh 1 AT 3000 algo 0 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-0-mod-tws_time.png" alt="mesh 1 AT 3000 algo 0 mod tws time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-1-mod-tws.png" alt="mesh 1 AT 3000 algo 1 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-1-AT-3000-algo-1-mod-tws_time.png" alt="mesh 1 AT 3000 algo 1 mod tws time"></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_mesh_2_3">Mesh 2</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-500-algo-0-mod-tws.png" alt="mesh 2 AT 500 algo 0 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-500-algo-0-mod-tws_time.png" alt="mesh 2 AT 500 algo 0 mod tws time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-500-algo-1-mod-tws.png" alt="mesh 2 AT 500 algo 1 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-500-algo-1-mod-tws_time.png" alt="mesh 2 AT 500 algo 1 mod tws time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-0-mod-tws.png" alt="mesh 2 AT 1000 algo 0 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-0-mod-tws_time.png" alt="mesh 2 AT 1000 algo 0 mod tws time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-1-mod-tws.png" alt="mesh 2 AT 1000 algo 1 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-1000-algo-1-mod-tws_time.png" alt="mesh 2 AT 1000 algo 1 mod tws time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-0-mod-tws.png" alt="mesh 2 AT 2000 algo 0 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-0-mod-tws_time.png" alt="mesh 2 AT 2000 algo 0 mod tws time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-1-mod-tws.png" alt="mesh 2 AT 2000 algo 1 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-2000-algo-1-mod-tws_time.png" alt="mesh 2 AT 2000 algo 1 mod tws time"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-0-mod-tws.png" alt="mesh 2 AT 3000 algo 0 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Picard
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-0-mod-tws_time.png" alt="mesh 2 AT 3000 algo 0 mod tws time"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-1-mod-tws.png" alt="mesh 2 AT 3000 algo 1 mod tws"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Polarization
<span class="image"><img src="Figures/mesh-2-AT-3000-algo-1-mod-tws_time.png" alt="mesh 2 AT 3000 algo 1 mod tws time"></span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comparision_with_team_workshop_13">Comparision with Team Workshop 13</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Mesh 1 - Saddle
<span class="image"><img src="Figures/tws13_saddle_1_1000.png" alt="tws13 saddle 1 1000"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Mesh 2 - Saddle
<span class="image"><img src="Figures/tws13_saddle_2_1000.png" alt="tws13 saddle 2 1000"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Mesh 1 - Regularized
<span class="image"><img src="Figures/tws13_stab_1_1000.png" alt="tws13 stab 1 1000"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000 AT - Mesh 2 - Regularized
<span class="image"><img src="Figures/tws13_stab_2_1000.png" alt="tws13 stab 2 1000"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Mesh 1 - Saddle
<span class="image"><img src="Figures/tws13_saddle_1_3000.png" alt="tws13 saddle 1 3000"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Mesh 2 - Saddle
<span class="image"><img src="Figures/tws13_saddle_2_3000.png" alt="tws13 saddle 2 3000"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Mesh 1 - Regularized
<span class="image"><img src="Figures/tws13_stab_1_3000.png" alt="tws13 stab 1 3000"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000 AT - Mesh 2 - Regularized
<span class="image"><img src="Figures/tws13_stab_2_3000.png" alt="tws13 stab 2 3000"></span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_remarks">Remarks</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Polarization or Picard ? </strong></p>
</div>
<div class="paragraph">
<p>At first, we can be dispointed with the very small advantage the Polarization method provide considering the computing time.
It has to be higlighted the <code>update()</code> method - for the non linear right hand side or the magnetic permeability - has an effect on the magnetic concrete.
As long as the ratio of magnetic concrete volume in the whole volume of computation is always little, we are not surprised to face a very little improvement in the method.
Actually, rebuilding the preconditioner does seem to be that time consuming.</p>
</div>
<div class="paragraph">
<p><strong>Saddle or Regularizd ? </strong></p>
</div>
<div class="paragraph">
<p>Considering our results, we recommend the following strategy:
- run the regularized formulation until a stationnary point is found,
- use the current \mathbb{A} as an initial guess for the saddle point method.</p>
</div>
<div class="paragraph">
<p><strong>\mu discretization</strong></p>
</div>
<div class="paragraph">
<p>Our calculus has not shown a sufficient difference to definitely chose.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_propositions">Propositions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here the ideas we do not have time to test.</p>
</div>
<div class="sect2">
<h3 id="_polarization">Polarization</h3>
<div class="paragraph">
<p>The polarization generate a right hand side that can present huge variations - see the B-H curve for B \approx 1.8 for example.
In the present geometry, the maximum of B is achieved at the boundary of the ferromagnetic concrete.
That is the non linear right hand side is discontinuous along the boundary of the ferromagnetic concrete, with a huge variation.
We recommend to test the L_2 projection of the non linear right hand side in the whole domain to smooth it, with a smoothing parameter decreasing with the iterations to decrease the effect of this projection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_continuity">Continuity</h3>
<div class="paragraph">
<p>Considering the convergence is mainly linked to the current density, a contiuation algorithm has to be testesd.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mixing_polarization_and_picard">Mixing Polarization and Picard.</h3>
<div class="paragraph">
<p>The Polarization method reads:

B = \mu_{opt} H + I

where the picard method reads:

B = \mu_0 \mu_r H

The idea we propose is to write:

\begin{aligned}
B^{(n)} &amp;= \mu_{opt} H ^{(n)} + I^{(n)} \\
        &amp;= \mu_0 \mu_r^{(n)} H^{(n)}
\end{aligned}

That is:

\mu_r^{(n)} = \frac{\mu_{opt}}{\mu_0} + \frac{1}{\mu_0 H^{(n)}} I^{(n)}
</p>
</div>
<div class="paragraph">
<p>That is we can transfert the non linearity from the right hand side to the matrix whenever we have to.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-03-17 22:37:08 CET
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>